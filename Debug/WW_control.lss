
AVRASM ver. 2.2.7  D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\main.asm Thu Apr 06 13:33:10 2023

[builtin](2): Including file 'C:/Program Files (x86)\Atmel\Studio\7.0\Packs\atmel\ATmega_DFP\1.2.209\avrasm\inc\m16adef.inc'
D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\main.asm(170): Including file 'D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\TWI_functions.asm'
D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\main.asm(171): Including file 'D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\MainFunctions.asm'
D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\main.asm(172): Including file 'D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\EncoderFunctions.asm'
D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\main.asm(173): Including file 'D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\Timers.asm'
D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\main.asm(174): Including file 'D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\UARTFunctions.asm'
D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\main.asm(175): Including file 'D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\ADC.asm'
D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\main.asm(176): Including file 'D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\TimeCorrect.asm'
D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\main.asm(177): Including file 'D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\EEPROMFunctions.asm'
[builtin](2): Including file 'C:/Program Files (x86)\Atmel\Studio\7.0\Packs\atmel\ATmega_DFP\1.2.209\avrasm\inc\m16adef.inc'
D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\main.asm(170): Including file 'D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\TWI_functions.asm'
D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\main.asm(171): Including file 'D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\MainFunctions.asm'
D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\main.asm(172): Including file 'D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\EncoderFunctions.asm'
D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\main.asm(173): Including file 'D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\Timers.asm'
D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\main.asm(174): Including file 'D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\UARTFunctions.asm'
D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\main.asm(175): Including file 'D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\ADC.asm'
D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\main.asm(176): Including file 'D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\TimeCorrect.asm'
D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\main.asm(177): Including file 'D:\PROJECTS_HFSS\PROJECTS_HFSS\Atmel Studio\Asm\Wall_watch_ver_2\Main\WW_control\EEPROMFunctions.asm'
                                 
                                 ;
                                 
                                 ;***** Created: 2011-02-09 12:03 ******* Source: ATmega16A.xml ***********
                                 ;*************************************************************************
                                 ;* A P P L I C A T I O N   N O T E   F O R   T H E   A V R   F A M I L Y
                                 ;* 
                                 ;* Number            : AVR000
                                 ;* File Name         : "m16Adef.inc"
                                 ;* Title             : Register/Bit Definitions for the ATmega16A
                                 ;* Date              : 2011-02-09
                                 ;* Version           : 2.35
                                 ;* Support E-mail    : avr@atmel.com
                                 ;* Target MCU        : ATmega16A
                                 ;* 
                                 ;* DESCRIPTION
                                 ;* When including this file in the assembly program file, all I/O register 
                                 ;* names and I/O register bit names appearing in the data book can be used.
                                 ;* In addition, the six registers forming the three data pointers X, Y and 
                                 ;* Z have been assigned names XL - ZH. Highest RAM address for Internal 
                                 ;* SRAM is also defined 
                                 ;* 
                                 ;* The Register names are represented by their hexadecimal address.
                                 ;* 
                                 ;* The Register Bit names are represented by their bit number (0-7).
                                 ;* 
                                 ;* Please observe the difference in using the bit names with instructions
                                 ;* such as "sbr"/"cbr" (set/clear bit in register) and "sbrs"/"sbrc"
                                 ;* (skip if bit in register set/cleared). The following example illustrates
                                 ;* this:
                                 ;* 
                                 ;* in    r16,PORTB             ;read PORTB latch
                                 ;* sbr   r16,(1<<PB6)+(1<<PB5) ;set PB6 and PB5 (use masks, not bit#)
                                 ;* out   PORTB,r16             ;output to PORTB
                                 ;* 
                                 ;* in    r16,TIFR              ;read the Timer Interrupt Flag Register
                                 ;* sbrc  r16,TOV0              ;test the overflow flag (use bit#)
                                 ;* rjmp  TOV0_is_set           ;jump if set
                                 ;* ...                         ;otherwise do something else
                                 ;*************************************************************************
                                 
                                 #ifndef _M16ADEF_INC_
                                 #define _M16ADEF_INC_
                                 
                                 
                                 #pragma partinc 0
                                 
                                 ; ***** SPECIFY DEVICE ***************************************************
                                 .device ATmega16A
                                 #pragma AVRPART ADMIN PART_NAME ATmega16A
                                 .equ	SIGNATURE_000	= 0x1e
                                 .equ	SIGNATURE_001	= 0x94
                                 .equ	SIGNATURE_002	= 0x03
                                 
                                 #pragma AVRPART CORE CORE_VERSION V2E
                                 
                                 
                                 ; ***** I/O REGISTER DEFINITIONS *****************************************
                                 ; NOTE:
                                 ; Definitions marked "MEMORY MAPPED"are extended I/O ports
                                 ; and cannot be used with IN/OUT instructions
                                 .equ	SREG	= 0x3f
                                 .equ	SPL	= 0x3d
                                 .equ	SPH	= 0x3e
                                 .equ	OCR0	= 0x3c
                                 .equ	GICR	= 0x3b
                                 .equ	GIFR	= 0x3a
                                 .equ	TIMSK	= 0x39
                                 .equ	TIFR	= 0x38
                                 .equ	SPMCSR	= 0x37
                                 .equ	TWCR	= 0x36
                                 .equ	MCUCR	= 0x35
                                 .equ	MCUCSR	= 0x34
                                 .equ	TCCR0	= 0x33
                                 .equ	TCNT0	= 0x32
                                 .equ	OSCCAL	= 0x31
                                 .equ	OCDR	= 0x31
                                 .equ	SFIOR	= 0x30
                                 .equ	TCCR1A	= 0x2f
                                 .equ	TCCR1B	= 0x2e
                                 .equ	TCNT1L	= 0x2c
                                 .equ	TCNT1H	= 0x2d
                                 .equ	OCR1AL	= 0x2a
                                 .equ	OCR1AH	= 0x2b
                                 .equ	OCR1BL	= 0x28
                                 .equ	OCR1BH	= 0x29
                                 .equ	ICR1L	= 0x26
                                 .equ	ICR1H	= 0x27
                                 .equ	TCCR2	= 0x25
                                 .equ	TCNT2	= 0x24
                                 .equ	OCR2	= 0x23
                                 .equ	ASSR	= 0x22
                                 .equ	WDTCR	= 0x21
                                 .equ	UBRRH	= 0x20
                                 .equ	UCSRC	= 0x20
                                 .equ	EEARL	= 0x1e
                                 .equ	EEARH	= 0x1f
                                 .equ	EEDR	= 0x1d
                                 .equ	EECR	= 0x1c
                                 .equ	PORTA	= 0x1b
                                 .equ	DDRA	= 0x1a
                                 .equ	PINA	= 0x19
                                 .equ	PORTB	= 0x18
                                 .equ	DDRB	= 0x17
                                 .equ	PINB	= 0x16
                                 .equ	PORTC	= 0x15
                                 .equ	DDRC	= 0x14
                                 .equ	PINC	= 0x13
                                 .equ	PORTD	= 0x12
                                 .equ	DDRD	= 0x11
                                 .equ	PIND	= 0x10
                                 .equ	SPDR	= 0x0f
                                 .equ	SPSR	= 0x0e
                                 .equ	SPCR	= 0x0d
                                 .equ	UDR	= 0x0c
                                 .equ	UCSRA	= 0x0b
                                 .equ	UCSRB	= 0x0a
                                 .equ	UBRRL	= 0x09
                                 .equ	ACSR	= 0x08
                                 .equ	ADMUX	= 0x07
                                 .equ	ADCSRA	= 0x06
                                 .equ	ADCH	= 0x05
                                 .equ	ADCL	= 0x04
                                 .equ	TWDR	= 0x03
                                 .equ	TWAR	= 0x02
                                 .equ	TWSR	= 0x01
                                 .equ	TWBR	= 0x00
                                 
                                 
                                 ; ***** BIT DEFINITIONS **************************************************
                                 
                                 ; ***** TIMER_COUNTER_0 **************
                                 ; TCCR0 - Timer/Counter Control Register
                                 .equ	CS00	= 0	; Clock Select 1
                                 .equ	CS01	= 1	; Clock Select 1
                                 .equ	CS02	= 2	; Clock Select 2
                                 .equ	WGM01	= 3	; Waveform Generation Mode 1
                                 .equ	CTC0	= WGM01	; For compatibility
                                 .equ	COM00	= 4	; Compare match Output Mode 0
                                 .equ	COM01	= 5	; Compare Match Output Mode 1
                                 .equ	WGM00	= 6	; Waveform Generation Mode 0
                                 .equ	PWM0	= WGM00	; For compatibility
                                 .equ	FOC0	= 7	; Force Output Compare
                                 
                                 ; TCNT0 - Timer/Counter Register
                                 .equ	TCNT0_0	= 0	; 
                                 .equ	TCNT0_1	= 1	; 
                                 .equ	TCNT0_2	= 2	; 
                                 .equ	TCNT0_3	= 3	; 
                                 .equ	TCNT0_4	= 4	; 
                                 .equ	TCNT0_5	= 5	; 
                                 .equ	TCNT0_6	= 6	; 
                                 .equ	TCNT0_7	= 7	; 
                                 
                                 ; OCR0 - Output Compare Register
                                 .equ	OCR0_0	= 0	; 
                                 .equ	OCR0_1	= 1	; 
                                 .equ	OCR0_2	= 2	; 
                                 .equ	OCR0_3	= 3	; 
                                 .equ	OCR0_4	= 4	; 
                                 .equ	OCR0_5	= 5	; 
                                 .equ	OCR0_6	= 6	; 
                                 .equ	OCR0_7	= 7	; 
                                 
                                 ; TIMSK - Timer/Counter Interrupt Mask Register
                                 .equ	TOIE0	= 0	; Timer/Counter0 Overflow Interrupt Enable
                                 .equ	OCIE0	= 1	; Timer/Counter0 Output Compare Match Interrupt register
                                 
                                 ; TIFR - Timer/Counter Interrupt Flag register
                                 .equ	TOV0	= 0	; Timer/Counter0 Overflow Flag
                                 .equ	OCF0	= 1	; Output Compare Flag 0
                                 
                                 ; SFIOR - Special Function IO Register
                                 .equ	PSR10	= 0	; Prescaler Reset Timer/Counter1 and Timer/Counter0
                                 
                                 
                                 ; ***** TIMER_COUNTER_1 **************
                                 ; TIMSK - Timer/Counter Interrupt Mask Register
                                 .equ	TOIE1	= 2	; Timer/Counter1 Overflow Interrupt Enable
                                 .equ	OCIE1B	= 3	; Timer/Counter1 Output CompareB Match Interrupt Enable
                                 .equ	OCIE1A	= 4	; Timer/Counter1 Output CompareA Match Interrupt Enable
                                 .equ	TICIE1	= 5	; Timer/Counter1 Input Capture Interrupt Enable
                                 
                                 ; TIFR - Timer/Counter Interrupt Flag register
                                 .equ	TOV1	= 2	; Timer/Counter1 Overflow Flag
                                 .equ	OCF1B	= 3	; Output Compare Flag 1B
                                 .equ	OCF1A	= 4	; Output Compare Flag 1A
                                 .equ	ICF1	= 5	; Input Capture Flag 1
                                 
                                 ; TCCR1A - Timer/Counter1 Control Register A
                                 .equ	WGM10	= 0	; Waveform Generation Mode
                                 .equ	PWM10	= WGM10	; For compatibility
                                 .equ	WGM11	= 1	; Waveform Generation Mode
                                 .equ	PWM11	= WGM11	; For compatibility
                                 .equ	FOC1B	= 2	; Force Output Compare 1B
                                 .equ	FOC1A	= 3	; Force Output Compare 1A
                                 .equ	COM1B0	= 4	; Compare Output Mode 1B, bit 0
                                 .equ	COM1B1	= 5	; Compare Output Mode 1B, bit 1
                                 .equ	COM1A0	= 6	; Compare Ouput Mode 1A, bit 0
                                 .equ	COM1A1	= 7	; Compare Output Mode 1A, bit 1
                                 
                                 ; TCCR1B - Timer/Counter1 Control Register B
                                 .equ	CS10	= 0	; Prescaler source of Timer/Counter 1
                                 .equ	CS11	= 1	; Prescaler source of Timer/Counter 1
                                 .equ	CS12	= 2	; Prescaler source of Timer/Counter 1
                                 .equ	WGM12	= 3	; Waveform Generation Mode
                                 .equ	CTC10	= WGM12	; For compatibility
                                 .equ	CTC1	= WGM12	; For compatibility
                                 .equ	WGM13	= 4	; Waveform Generation Mode
                                 .equ	CTC11	= WGM13	; For compatibility
                                 .equ	ICES1	= 6	; Input Capture 1 Edge Select
                                 .equ	ICNC1	= 7	; Input Capture 1 Noise Canceler
                                 
                                 
                                 ; ***** EXTERNAL_INTERRUPT ***********
                                 ; GICR - General Interrupt Control Register
                                 .equ	GIMSK	= GICR	; For compatibility
                                 .equ	IVCE	= 0	; Interrupt Vector Change Enable
                                 .equ	IVSEL	= 1	; Interrupt Vector Select
                                 .equ	INT2	= 5	; External Interrupt Request 2 Enable
                                 .equ	INT0	= 6	; External Interrupt Request 0 Enable
                                 .equ	INT1	= 7	; External Interrupt Request 1 Enable
                                 
                                 ; GIFR - General Interrupt Flag Register
                                 .equ	INTF2	= 5	; External Interrupt Flag 2
                                 .equ	INTF0	= 6	; External Interrupt Flag 0
                                 .equ	INTF1	= 7	; External Interrupt Flag 1
                                 
                                 ; MCUCR - General Interrupt Control Register
                                 .equ	ISC00	= 0	; Interrupt Sense Control 0 Bit 0
                                 .equ	ISC01	= 1	; Interrupt Sense Control 0 Bit 1
                                 .equ	ISC10	= 2	; Interrupt Sense Control 1 Bit 0
                                 .equ	ISC11	= 3	; Interrupt Sense Control 1 Bit 1
                                 
                                 ; MCUCSR - MCU Control And Status Register
                                 .equ	ISC2	= 6	; Interrupt Sense Control 2
                                 
                                 
                                 ; ***** EEPROM ***********************
                                 ; EEDR - EEPROM Data Register
                                 .equ	EEDR0	= 0	; EEPROM Data Register bit 0
                                 .equ	EEDR1	= 1	; EEPROM Data Register bit 1
                                 .equ	EEDR2	= 2	; EEPROM Data Register bit 2
                                 .equ	EEDR3	= 3	; EEPROM Data Register bit 3
                                 .equ	EEDR4	= 4	; EEPROM Data Register bit 4
                                 .equ	EEDR5	= 5	; EEPROM Data Register bit 5
                                 .equ	EEDR6	= 6	; EEPROM Data Register bit 6
                                 .equ	EEDR7	= 7	; EEPROM Data Register bit 7
                                 
                                 ; EECR - EEPROM Control Register
                                 .equ	EERE	= 0	; EEPROM Read Enable
                                 .equ	EEWE	= 1	; EEPROM Write Enable
                                 .equ	EEMWE	= 2	; EEPROM Master Write Enable
                                 .equ	EEWEE	= EEMWE	; For compatibility
                                 .equ	EERIE	= 3	; EEPROM Ready Interrupt Enable
                                 
                                 
                                 ; ***** CPU **************************
                                 ; SREG - Status Register
                                 .equ	SREG_C	= 0	; Carry Flag
                                 .equ	SREG_Z	= 1	; Zero Flag
                                 .equ	SREG_N	= 2	; Negative Flag
                                 .equ	SREG_V	= 3	; Two's Complement Overflow Flag
                                 .equ	SREG_S	= 4	; Sign Bit
                                 .equ	SREG_H	= 5	; Half Carry Flag
                                 .equ	SREG_T	= 6	; Bit Copy Storage
                                 .equ	SREG_I	= 7	; Global Interrupt Enable
                                 
                                 ; MCUCR - MCU Control Register
                                 ;.equ	ISC00	= 0	; Interrupt Sense Control 0 Bit 0
                                 ;.equ	ISC01	= 1	; Interrupt Sense Control 0 Bit 1
                                 ;.equ	ISC10	= 2	; Interrupt Sense Control 1 Bit 0
                                 ;.equ	ISC11	= 3	; Interrupt Sense Control 1 Bit 1
                                 .equ	SM0	= 4	; Sleep Mode Select
                                 .equ	SM1	= 5	; Sleep Mode Select
                                 .equ	SE	= 6	; Sleep Enable
                                 .equ	SM2	= 7	; Sleep Mode Select
                                 
                                 ; MCUCSR - MCU Control And Status Register
                                 .equ	MCUSR	= MCUCSR	; For compatibility
                                 .equ	PORF	= 0	; Power-on reset flag
                                 .equ	EXTRF	= 1	; External Reset Flag
                                 .equ	EXTREF	= EXTRF	; For compatibility
                                 .equ	BORF	= 2	; Brown-out Reset Flag
                                 .equ	WDRF	= 3	; Watchdog Reset Flag
                                 .equ	JTRF	= 4	; JTAG Reset Flag
                                 .equ	JTD	= 7	; JTAG Interface Disable
                                 
                                 ; OSCCAL - Oscillator Calibration Value
                                 .equ	CAL0	= 0	; Oscillator Calibration Value Bit0
                                 .equ	CAL1	= 1	; Oscillator Calibration Value Bit1
                                 .equ	CAL2	= 2	; Oscillator Calibration Value Bit2
                                 .equ	CAL3	= 3	; Oscillator Calibration Value Bit3
                                 .equ	CAL4	= 4	; Oscillator Calibration Value Bit4
                                 .equ	CAL5	= 5	; Oscillator Calibration Value Bit5
                                 .equ	CAL6	= 6	; Oscillator Calibration Value Bit6
                                 .equ	CAL7	= 7	; Oscillator Calibration Value Bit7
                                 
                                 ; SFIOR - Special function I/O register
                                 ;.equ	PSR10	= 0	; Prescaler reset
                                 .equ	PSR2	= 1	; Prescaler reset
                                 .equ	PUD	= 2	; Pull-up Disable
                                 
                                 
                                 ; ***** TIMER_COUNTER_2 **************
                                 ; TIMSK - Timer/Counter Interrupt Mask register
                                 .equ	TOIE2	= 6	; Timer/Counter2 Overflow Interrupt Enable
                                 .equ	OCIE2	= 7	; Timer/Counter2 Output Compare Match Interrupt Enable
                                 
                                 ; TIFR - Timer/Counter Interrupt Flag Register
                                 .equ	TOV2	= 6	; Timer/Counter2 Overflow Flag
                                 .equ	OCF2	= 7	; Output Compare Flag 2
                                 
                                 ; TCCR2 - Timer/Counter2 Control Register
                                 .equ	CS20	= 0	; Clock Select bit 0
                                 .equ	CS21	= 1	; Clock Select bit 1
                                 .equ	CS22	= 2	; Clock Select bit 2
                                 .equ	WGM21	= 3	; Waveform Generation Mode
                                 .equ	CTC2	= WGM21	; For compatibility
                                 .equ	COM20	= 4	; Compare Output Mode bit 0
                                 .equ	COM21	= 5	; Compare Output Mode bit 1
                                 .equ	WGM20	= 6	; Waveform Genration Mode
                                 .equ	PWM2	= WGM20	; For compatibility
                                 .equ	FOC2	= 7	; Force Output Compare
                                 
                                 ; TCNT2 - Timer/Counter2
                                 .equ	TCNT2_0	= 0	; Timer/Counter 2 bit 0
                                 .equ	TCNT2_1	= 1	; Timer/Counter 2 bit 1
                                 .equ	TCNT2_2	= 2	; Timer/Counter 2 bit 2
                                 .equ	TCNT2_3	= 3	; Timer/Counter 2 bit 3
                                 .equ	TCNT2_4	= 4	; Timer/Counter 2 bit 4
                                 .equ	TCNT2_5	= 5	; Timer/Counter 2 bit 5
                                 .equ	TCNT2_6	= 6	; Timer/Counter 2 bit 6
                                 .equ	TCNT2_7	= 7	; Timer/Counter 2 bit 7
                                 
                                 ; OCR2 - Timer/Counter2 Output Compare Register
                                 .equ	OCR2_0	= 0	; Timer/Counter2 Output Compare Register Bit 0
                                 .equ	OCR2_1	= 1	; Timer/Counter2 Output Compare Register Bit 1
                                 .equ	OCR2_2	= 2	; Timer/Counter2 Output Compare Register Bit 2
                                 .equ	OCR2_3	= 3	; Timer/Counter2 Output Compare Register Bit 3
                                 .equ	OCR2_4	= 4	; Timer/Counter2 Output Compare Register Bit 4
                                 .equ	OCR2_5	= 5	; Timer/Counter2 Output Compare Register Bit 5
                                 .equ	OCR2_6	= 6	; Timer/Counter2 Output Compare Register Bit 6
                                 .equ	OCR2_7	= 7	; Timer/Counter2 Output Compare Register Bit 7
                                 
                                 ; ASSR - Asynchronous Status Register
                                 .equ	TCR2UB	= 0	; Timer/counter Control Register2 Update Busy
                                 .equ	OCR2UB	= 1	; Output Compare Register2 Update Busy
                                 .equ	TCN2UB	= 2	; Timer/Counter2 Update Busy
                                 .equ	AS2	= 3	; Asynchronous Timer/counter2
                                 
                                 ; SFIOR - Special Function IO Register
                                 ;.equ	PSR2	= 1	; Prescaler Reset Timer/Counter2
                                 
                                 
                                 ; ***** SPI **************************
                                 ; SPDR - SPI Data Register
                                 .equ	SPDR0	= 0	; SPI Data Register bit 0
                                 .equ	SPDR1	= 1	; SPI Data Register bit 1
                                 .equ	SPDR2	= 2	; SPI Data Register bit 2
                                 .equ	SPDR3	= 3	; SPI Data Register bit 3
                                 .equ	SPDR4	= 4	; SPI Data Register bit 4
                                 .equ	SPDR5	= 5	; SPI Data Register bit 5
                                 .equ	SPDR6	= 6	; SPI Data Register bit 6
                                 .equ	SPDR7	= 7	; SPI Data Register bit 7
                                 
                                 ; SPSR - SPI Status Register
                                 .equ	SPI2X	= 0	; Double SPI Speed Bit
                                 .equ	WCOL	= 6	; Write Collision Flag
                                 .equ	SPIF	= 7	; SPI Interrupt Flag
                                 
                                 ; SPCR - SPI Control Register
                                 .equ	SPR0	= 0	; SPI Clock Rate Select 0
                                 .equ	SPR1	= 1	; SPI Clock Rate Select 1
                                 .equ	CPHA	= 2	; Clock Phase
                                 .equ	CPOL	= 3	; Clock polarity
                                 .equ	MSTR	= 4	; Master/Slave Select
                                 .equ	DORD	= 5	; Data Order
                                 .equ	SPE	= 6	; SPI Enable
                                 .equ	SPIE	= 7	; SPI Interrupt Enable
                                 
                                 
                                 ; ***** USART ************************
                                 ; UDR - USART I/O Data Register
                                 .equ	UDR0	= 0	; USART I/O Data Register bit 0
                                 .equ	UDR1	= 1	; USART I/O Data Register bit 1
                                 .equ	UDR2	= 2	; USART I/O Data Register bit 2
                                 .equ	UDR3	= 3	; USART I/O Data Register bit 3
                                 .equ	UDR4	= 4	; USART I/O Data Register bit 4
                                 .equ	UDR5	= 5	; USART I/O Data Register bit 5
                                 .equ	UDR6	= 6	; USART I/O Data Register bit 6
                                 .equ	UDR7	= 7	; USART I/O Data Register bit 7
                                 
                                 ; UCSRA - USART Control and Status Register A
                                 .equ	USR	= UCSRA	; For compatibility
                                 .equ	MPCM	= 0	; Multi-processor Communication Mode
                                 .equ	U2X	= 1	; Double the USART transmission speed
                                 .equ	UPE	= 2	; Parity Error
                                 .equ	PE	= UPE	; For compatibility
                                 .equ	DOR	= 3	; Data overRun
                                 .equ	FE	= 4	; Framing Error
                                 .equ	UDRE	= 5	; USART Data Register Empty
                                 .equ	TXC	= 6	; USART Transmitt Complete
                                 .equ	RXC	= 7	; USART Receive Complete
                                 
                                 ; UCSRB - USART Control and Status Register B
                                 .equ	UCR	= UCSRB	; For compatibility
                                 .equ	TXB8	= 0	; Transmit Data Bit 8
                                 .equ	RXB8	= 1	; Receive Data Bit 8
                                 .equ	UCSZ2	= 2	; Character Size
                                 .equ	CHR9	= UCSZ2	; For compatibility
                                 .equ	TXEN	= 3	; Transmitter Enable
                                 .equ	RXEN	= 4	; Receiver Enable
                                 .equ	UDRIE	= 5	; USART Data register Empty Interrupt Enable
                                 .equ	TXCIE	= 6	; TX Complete Interrupt Enable
                                 .equ	RXCIE	= 7	; RX Complete Interrupt Enable
                                 
                                 ; UCSRC - USART Control and Status Register C
                                 .equ	UCPOL	= 0	; Clock Polarity
                                 .equ	UCSZ0	= 1	; Character Size
                                 .equ	UCSZ1	= 2	; Character Size
                                 .equ	USBS	= 3	; Stop Bit Select
                                 .equ	UPM0	= 4	; Parity Mode Bit 0
                                 .equ	UPM1	= 5	; Parity Mode Bit 1
                                 .equ	UMSEL	= 6	; USART Mode Select
                                 .equ	URSEL	= 7	; Register Select
                                 
                                 .equ	UBRRHI	= UBRRH	; For compatibility
                                 
                                 ; ***** TWI **************************
                                 ; TWBR - TWI Bit Rate register
                                 .equ	I2BR	= TWBR	; For compatibility
                                 .equ	TWBR0	= 0	; 
                                 .equ	TWBR1	= 1	; 
                                 .equ	TWBR2	= 2	; 
                                 .equ	TWBR3	= 3	; 
                                 .equ	TWBR4	= 4	; 
                                 .equ	TWBR5	= 5	; 
                                 .equ	TWBR6	= 6	; 
                                 .equ	TWBR7	= 7	; 
                                 
                                 ; TWCR - TWI Control Register
                                 .equ	I2CR	= TWCR	; For compatibility
                                 .equ	TWIE	= 0	; TWI Interrupt Enable
                                 .equ	I2IE	= TWIE	; For compatibility
                                 .equ	TWEN	= 2	; TWI Enable Bit
                                 .equ	I2EN	= TWEN	; For compatibility
                                 .equ	ENI2C	= TWEN	; For compatibility
                                 .equ	TWWC	= 3	; TWI Write Collition Flag
                                 .equ	I2WC	= TWWC	; For compatibility
                                 .equ	TWSTO	= 4	; TWI Stop Condition Bit
                                 .equ	I2STO	= TWSTO	; For compatibility
                                 .equ	TWSTA	= 5	; TWI Start Condition Bit
                                 .equ	I2STA	= TWSTA	; For compatibility
                                 .equ	TWEA	= 6	; TWI Enable Acknowledge Bit
                                 .equ	I2EA	= TWEA	; For compatibility
                                 .equ	TWINT	= 7	; TWI Interrupt Flag
                                 .equ	I2INT	= TWINT	; For compatibility
                                 
                                 ; TWSR - TWI Status Register
                                 .equ	I2SR	= TWSR	; For compatibility
                                 .equ	TWPS0	= 0	; TWI Prescaler
                                 .equ	TWS0	= TWPS0	; For compatibility
                                 .equ	I2GCE	= TWPS0	; For compatibility
                                 .equ	TWPS1	= 1	; TWI Prescaler
                                 .equ	TWS1	= TWPS1	; For compatibility
                                 .equ	TWS3	= 3	; TWI Status
                                 .equ	I2S3	= TWS3	; For compatibility
                                 .equ	TWS4	= 4	; TWI Status
                                 .equ	I2S4	= TWS4	; For compatibility
                                 .equ	TWS5	= 5	; TWI Status
                                 .equ	I2S5	= TWS5	; For compatibility
                                 .equ	TWS6	= 6	; TWI Status
                                 .equ	I2S6	= TWS6	; For compatibility
                                 .equ	TWS7	= 7	; TWI Status
                                 .equ	I2S7	= TWS7	; For compatibility
                                 
                                 ; TWDR - TWI Data register
                                 .equ	I2DR	= TWDR	; For compatibility
                                 .equ	TWD0	= 0	; TWI Data Register Bit 0
                                 .equ	TWD1	= 1	; TWI Data Register Bit 1
                                 .equ	TWD2	= 2	; TWI Data Register Bit 2
                                 .equ	TWD3	= 3	; TWI Data Register Bit 3
                                 .equ	TWD4	= 4	; TWI Data Register Bit 4
                                 .equ	TWD5	= 5	; TWI Data Register Bit 5
                                 .equ	TWD6	= 6	; TWI Data Register Bit 6
                                 .equ	TWD7	= 7	; TWI Data Register Bit 7
                                 
                                 ; TWAR - TWI (Slave) Address register
                                 .equ	I2AR	= TWAR	; For compatibility
                                 .equ	TWGCE	= 0	; TWI General Call Recognition Enable Bit
                                 .equ	TWA0	= 1	; TWI (Slave) Address register Bit 0
                                 .equ	TWA1	= 2	; TWI (Slave) Address register Bit 1
                                 .equ	TWA2	= 3	; TWI (Slave) Address register Bit 2
                                 .equ	TWA3	= 4	; TWI (Slave) Address register Bit 3
                                 .equ	TWA4	= 5	; TWI (Slave) Address register Bit 4
                                 .equ	TWA5	= 6	; TWI (Slave) Address register Bit 5
                                 .equ	TWA6	= 7	; TWI (Slave) Address register Bit 6
                                 
                                 
                                 ; ***** ANALOG_COMPARATOR ************
                                 ; SFIOR - Special Function IO Register
                                 .equ	ACME	= 3	; Analog Comparator Multiplexer Enable
                                 
                                 ; ACSR - Analog Comparator Control And Status Register
                                 .equ	ACIS0	= 0	; Analog Comparator Interrupt Mode Select bit 0
                                 .equ	ACIS1	= 1	; Analog Comparator Interrupt Mode Select bit 1
                                 .equ	ACIC	= 2	; Analog Comparator Input Capture Enable
                                 .equ	ACIE	= 3	; Analog Comparator Interrupt Enable
                                 .equ	ACI	= 4	; Analog Comparator Interrupt Flag
                                 .equ	ACO	= 5	; Analog Compare Output
                                 .equ	ACBG	= 6	; Analog Comparator Bandgap Select
                                 .equ	ACD	= 7	; Analog Comparator Disable
                                 
                                 
                                 ; ***** AD_CONVERTER *****************
                                 ; ADMUX - The ADC multiplexer Selection Register
                                 .equ	MUX0	= 0	; Analog Channel and Gain Selection Bits
                                 .equ	MUX1	= 1	; Analog Channel and Gain Selection Bits
                                 .equ	MUX2	= 2	; Analog Channel and Gain Selection Bits
                                 .equ	MUX3	= 3	; Analog Channel and Gain Selection Bits
                                 .equ	MUX4	= 4	; Analog Channel and Gain Selection Bits
                                 .equ	ADLAR	= 5	; Left Adjust Result
                                 .equ	REFS0	= 6	; Reference Selection Bit 0
                                 .equ	REFS1	= 7	; Reference Selection Bit 1
                                 
                                 ; ADCSRA - The ADC Control and Status register
                                 .equ	ADCSR	= ADCSRA	; For compatibility
                                 .equ	ADPS0	= 0	; ADC  Prescaler Select Bits
                                 .equ	ADPS1	= 1	; ADC  Prescaler Select Bits
                                 .equ	ADPS2	= 2	; ADC  Prescaler Select Bits
                                 .equ	ADIE	= 3	; ADC Interrupt Enable
                                 .equ	ADIF	= 4	; ADC Interrupt Flag
                                 .equ	ADATE	= 5	; When this bit is written to one,the Timer/Counter2 prescaler will be reset.The bit will be cleared by hardware after the operation is performed.Writing a zero to this bit will have no effect.This bit will always be read as zero if Timer/C                                 ounter2 is clocked by the internal CPU clock.If this bit is written when Timer/Counter2 is operating in asynchronous mode,the bit will remain one until the prescaler has been reset.
                                 .equ	ADFR	= ADATE	; For compatibility
                                 .equ	ADSC	= 6	; ADC Start Conversion
                                 .equ	ADEN	= 7	; ADC Enable
                                 
                                 ; ADCH - ADC Data Register High Byte
                                 .equ	ADCH0	= 0	; ADC Data Register High Byte Bit 0
                                 .equ	ADCH1	= 1	; ADC Data Register High Byte Bit 1
                                 .equ	ADCH2	= 2	; ADC Data Register High Byte Bit 2
                                 .equ	ADCH3	= 3	; ADC Data Register High Byte Bit 3
                                 .equ	ADCH4	= 4	; ADC Data Register High Byte Bit 4
                                 .equ	ADCH5	= 5	; ADC Data Register High Byte Bit 5
                                 .equ	ADCH6	= 6	; ADC Data Register High Byte Bit 6
                                 .equ	ADCH7	= 7	; ADC Data Register High Byte Bit 7
                                 
                                 ; ADCL - ADC Data Register Low Byte
                                 .equ	ADCL0	= 0	; ADC Data Register Low Byte Bit 0
                                 .equ	ADCL1	= 1	; ADC Data Register Low Byte Bit 1
                                 .equ	ADCL2	= 2	; ADC Data Register Low Byte Bit 2
                                 .equ	ADCL3	= 3	; ADC Data Register Low Byte Bit 3
                                 .equ	ADCL4	= 4	; ADC Data Register Low Byte Bit 4
                                 .equ	ADCL5	= 5	; ADC Data Register Low Byte Bit 5
                                 .equ	ADCL6	= 6	; ADC Data Register Low Byte Bit 6
                                 .equ	ADCL7	= 7	; ADC Data Register Low Byte Bit 7
                                 
                                 ; SFIOR - Special Function IO Register
                                 .equ	ADTS0	= 5	; ADC Auto Trigger Source 0
                                 .equ	ADTS1	= 6	; ADC Auto Trigger Source 1
                                 .equ	ADTS2	= 7	; ADC Auto Trigger Source 2
                                 
                                 
                                 ; ***** JTAG *************************
                                 ; OCDR - On-Chip Debug Related Register in I/O Memory
                                 .equ	OCDR0	= 0	; On-Chip Debug Register Bit 0
                                 .equ	OCDR1	= 1	; On-Chip Debug Register Bit 1
                                 .equ	OCDR2	= 2	; On-Chip Debug Register Bit 2
                                 .equ	OCDR3	= 3	; On-Chip Debug Register Bit 3
                                 .equ	OCDR4	= 4	; On-Chip Debug Register Bit 4
                                 .equ	OCDR5	= 5	; On-Chip Debug Register Bit 5
                                 .equ	OCDR6	= 6	; On-Chip Debug Register Bit 6
                                 .equ	OCDR7	= 7	; On-Chip Debug Register Bit 7
                                 .equ	IDRD	= OCDR7	; For compatibility
                                 
                                 ; MCUCSR - MCU Control And Status Register
                                 ;.equ	JTRF	= 4	; JTAG Reset Flag
                                 ;.equ	JTD	= 7	; JTAG Interface Disable
                                 
                                 
                                 ; ***** BOOT_LOAD ********************
                                 ; SPMCSR - Store Program Memory Control Register
                                 .equ	SPMCR	= SPMCSR	; For compatibility
                                 .equ	SPMEN	= 0	; Store Program Memory Enable
                                 .equ	PGERS	= 1	; Page Erase
                                 .equ	PGWRT	= 2	; Page Write
                                 .equ	BLBSET	= 3	; Boot Lock Bit Set
                                 .equ	RWWSRE	= 4	; Read While Write section read enable
                                 .equ	ASRE	= RWWSRE	; For compatibility
                                 .equ	RWWSB	= 6	; Read While Write Section Busy
                                 .equ	ASB	= RWWSB	; For compatibility
                                 .equ	SPMIE	= 7	; SPM Interrupt Enable
                                 
                                 
                                 ; ***** PORTA ************************
                                 ; PORTA - Port A Data Register
                                 .equ	PORTA0	= 0	; Port A Data Register bit 0
                                 .equ	PA0	= 0	; For compatibility
                                 .equ	PORTA1	= 1	; Port A Data Register bit 1
                                 .equ	PA1	= 1	; For compatibility
                                 .equ	PORTA2	= 2	; Port A Data Register bit 2
                                 .equ	PA2	= 2	; For compatibility
                                 .equ	PORTA3	= 3	; Port A Data Register bit 3
                                 .equ	PA3	= 3	; For compatibility
                                 .equ	PORTA4	= 4	; Port A Data Register bit 4
                                 .equ	PA4	= 4	; For compatibility
                                 .equ	PORTA5	= 5	; Port A Data Register bit 5
                                 .equ	PA5	= 5	; For compatibility
                                 .equ	PORTA6	= 6	; Port A Data Register bit 6
                                 .equ	PA6	= 6	; For compatibility
                                 .equ	PORTA7	= 7	; Port A Data Register bit 7
                                 .equ	PA7	= 7	; For compatibility
                                 
                                 ; DDRA - Port A Data Direction Register
                                 .equ	DDA0	= 0	; Data Direction Register, Port A, bit 0
                                 .equ	DDA1	= 1	; Data Direction Register, Port A, bit 1
                                 .equ	DDA2	= 2	; Data Direction Register, Port A, bit 2
                                 .equ	DDA3	= 3	; Data Direction Register, Port A, bit 3
                                 .equ	DDA4	= 4	; Data Direction Register, Port A, bit 4
                                 .equ	DDA5	= 5	; Data Direction Register, Port A, bit 5
                                 .equ	DDA6	= 6	; Data Direction Register, Port A, bit 6
                                 .equ	DDA7	= 7	; Data Direction Register, Port A, bit 7
                                 
                                 ; PINA - Port A Input Pins
                                 .equ	PINA0	= 0	; Input Pins, Port A bit 0
                                 .equ	PINA1	= 1	; Input Pins, Port A bit 1
                                 .equ	PINA2	= 2	; Input Pins, Port A bit 2
                                 .equ	PINA3	= 3	; Input Pins, Port A bit 3
                                 .equ	PINA4	= 4	; Input Pins, Port A bit 4
                                 .equ	PINA5	= 5	; Input Pins, Port A bit 5
                                 .equ	PINA6	= 6	; Input Pins, Port A bit 6
                                 .equ	PINA7	= 7	; Input Pins, Port A bit 7
                                 
                                 
                                 ; ***** PORTB ************************
                                 ; PORTB - Port B Data Register
                                 .equ	PORTB0	= 0	; Port B Data Register bit 0
                                 .equ	PB0	= 0	; For compatibility
                                 .equ	PORTB1	= 1	; Port B Data Register bit 1
                                 .equ	PB1	= 1	; For compatibility
                                 .equ	PORTB2	= 2	; Port B Data Register bit 2
                                 .equ	PB2	= 2	; For compatibility
                                 .equ	PORTB3	= 3	; Port B Data Register bit 3
                                 .equ	PB3	= 3	; For compatibility
                                 .equ	PORTB4	= 4	; Port B Data Register bit 4
                                 .equ	PB4	= 4	; For compatibility
                                 .equ	PORTB5	= 5	; Port B Data Register bit 5
                                 .equ	PB5	= 5	; For compatibility
                                 .equ	PORTB6	= 6	; Port B Data Register bit 6
                                 .equ	PB6	= 6	; For compatibility
                                 .equ	PORTB7	= 7	; Port B Data Register bit 7
                                 .equ	PB7	= 7	; For compatibility
                                 
                                 ; DDRB - Port B Data Direction Register
                                 .equ	DDB0	= 0	; Port B Data Direction Register bit 0
                                 .equ	DDB1	= 1	; Port B Data Direction Register bit 1
                                 .equ	DDB2	= 2	; Port B Data Direction Register bit 2
                                 .equ	DDB3	= 3	; Port B Data Direction Register bit 3
                                 .equ	DDB4	= 4	; Port B Data Direction Register bit 4
                                 .equ	DDB5	= 5	; Port B Data Direction Register bit 5
                                 .equ	DDB6	= 6	; Port B Data Direction Register bit 6
                                 .equ	DDB7	= 7	; Port B Data Direction Register bit 7
                                 
                                 ; PINB - Port B Input Pins
                                 .equ	PINB0	= 0	; Port B Input Pins bit 0
                                 .equ	PINB1	= 1	; Port B Input Pins bit 1
                                 .equ	PINB2	= 2	; Port B Input Pins bit 2
                                 .equ	PINB3	= 3	; Port B Input Pins bit 3
                                 .equ	PINB4	= 4	; Port B Input Pins bit 4
                                 .equ	PINB5	= 5	; Port B Input Pins bit 5
                                 .equ	PINB6	= 6	; Port B Input Pins bit 6
                                 .equ	PINB7	= 7	; Port B Input Pins bit 7
                                 
                                 
                                 ; ***** PORTC ************************
                                 ; PORTC - Port C Data Register
                                 .equ	PORTC0	= 0	; Port C Data Register bit 0
                                 .equ	PC0	= 0	; For compatibility
                                 .equ	PORTC1	= 1	; Port C Data Register bit 1
                                 .equ	PC1	= 1	; For compatibility
                                 .equ	PORTC2	= 2	; Port C Data Register bit 2
                                 .equ	PC2	= 2	; For compatibility
                                 .equ	PORTC3	= 3	; Port C Data Register bit 3
                                 .equ	PC3	= 3	; For compatibility
                                 .equ	PORTC4	= 4	; Port C Data Register bit 4
                                 .equ	PC4	= 4	; For compatibility
                                 .equ	PORTC5	= 5	; Port C Data Register bit 5
                                 .equ	PC5	= 5	; For compatibility
                                 .equ	PORTC6	= 6	; Port C Data Register bit 6
                                 .equ	PC6	= 6	; For compatibility
                                 .equ	PORTC7	= 7	; Port C Data Register bit 7
                                 .equ	PC7	= 7	; For compatibility
                                 
                                 ; DDRC - Port C Data Direction Register
                                 .equ	DDC0	= 0	; Port C Data Direction Register bit 0
                                 .equ	DDC1	= 1	; Port C Data Direction Register bit 1
                                 .equ	DDC2	= 2	; Port C Data Direction Register bit 2
                                 .equ	DDC3	= 3	; Port C Data Direction Register bit 3
                                 .equ	DDC4	= 4	; Port C Data Direction Register bit 4
                                 .equ	DDC5	= 5	; Port C Data Direction Register bit 5
                                 .equ	DDC6	= 6	; Port C Data Direction Register bit 6
                                 .equ	DDC7	= 7	; Port C Data Direction Register bit 7
                                 
                                 ; PINC - Port C Input Pins
                                 .equ	PINC0	= 0	; Port C Input Pins bit 0
                                 .equ	PINC1	= 1	; Port C Input Pins bit 1
                                 .equ	PINC2	= 2	; Port C Input Pins bit 2
                                 .equ	PINC3	= 3	; Port C Input Pins bit 3
                                 .equ	PINC4	= 4	; Port C Input Pins bit 4
                                 .equ	PINC5	= 5	; Port C Input Pins bit 5
                                 .equ	PINC6	= 6	; Port C Input Pins bit 6
                                 .equ	PINC7	= 7	; Port C Input Pins bit 7
                                 
                                 
                                 ; ***** PORTD ************************
                                 ; PORTD - Port D Data Register
                                 .equ	PORTD0	= 0	; Port D Data Register bit 0
                                 .equ	PD0	= 0	; For compatibility
                                 .equ	PORTD1	= 1	; Port D Data Register bit 1
                                 .equ	PD1	= 1	; For compatibility
                                 .equ	PORTD2	= 2	; Port D Data Register bit 2
                                 .equ	PD2	= 2	; For compatibility
                                 .equ	PORTD3	= 3	; Port D Data Register bit 3
                                 .equ	PD3	= 3	; For compatibility
                                 .equ	PORTD4	= 4	; Port D Data Register bit 4
                                 .equ	PD4	= 4	; For compatibility
                                 .equ	PORTD5	= 5	; Port D Data Register bit 5
                                 .equ	PD5	= 5	; For compatibility
                                 .equ	PORTD6	= 6	; Port D Data Register bit 6
                                 .equ	PD6	= 6	; For compatibility
                                 .equ	PORTD7	= 7	; Port D Data Register bit 7
                                 .equ	PD7	= 7	; For compatibility
                                 
                                 ; DDRD - Port D Data Direction Register
                                 .equ	DDD0	= 0	; Port D Data Direction Register bit 0
                                 .equ	DDD1	= 1	; Port D Data Direction Register bit 1
                                 .equ	DDD2	= 2	; Port D Data Direction Register bit 2
                                 .equ	DDD3	= 3	; Port D Data Direction Register bit 3
                                 .equ	DDD4	= 4	; Port D Data Direction Register bit 4
                                 .equ	DDD5	= 5	; Port D Data Direction Register bit 5
                                 .equ	DDD6	= 6	; Port D Data Direction Register bit 6
                                 .equ	DDD7	= 7	; Port D Data Direction Register bit 7
                                 
                                 ; PIND - Port D Input Pins
                                 .equ	PIND0	= 0	; Port D Input Pins bit 0
                                 .equ	PIND1	= 1	; Port D Input Pins bit 1
                                 .equ	PIND2	= 2	; Port D Input Pins bit 2
                                 .equ	PIND3	= 3	; Port D Input Pins bit 3
                                 .equ	PIND4	= 4	; Port D Input Pins bit 4
                                 .equ	PIND5	= 5	; Port D Input Pins bit 5
                                 .equ	PIND6	= 6	; Port D Input Pins bit 6
                                 .equ	PIND7	= 7	; Port D Input Pins bit 7
                                 
                                 
                                 ; ***** WATCHDOG *********************
                                 ; WDTCR - Watchdog Timer Control Register
                                 .equ	WDP0	= 0	; Watch Dog Timer Prescaler bit 0
                                 .equ	WDP1	= 1	; Watch Dog Timer Prescaler bit 1
                                 .equ	WDP2	= 2	; Watch Dog Timer Prescaler bit 2
                                 .equ	WDE	= 3	; Watch Dog Enable
                                 .equ	WDTOE	= 4	; RW
                                 .equ	WDDE	= WDTOE	; For compatibility
                                 
                                 
                                 
                                 ; ***** LOCKSBITS ********************************************************
                                 .equ	LB1	= 0	; Lock bit
                                 .equ	LB2	= 1	; Lock bit
                                 .equ	BLB01	= 2	; Boot Lock bit
                                 .equ	BLB02	= 3	; Boot Lock bit
                                 .equ	BLB11	= 4	; Boot lock bit
                                 .equ	BLB12	= 5	; Boot lock bit
                                 
                                 
                                 ; ***** FUSES ************************************************************
                                 ; LOW fuse bits
                                 .equ	CKSEL0	= 0	; Select Clock Source
                                 .equ	CKSEL1	= 1	; Select Clock Source
                                 .equ	CKSEL2	= 2	; Select Clock Source
                                 .equ	CKSEL3	= 3	; Select Clock Source
                                 .equ	SUT0	= 4	; Select start-up time
                                 .equ	SUT1	= 5	; Select start-up time
                                 .equ	BODEN	= 6	; Brown out detector enable
                                 .equ	BODLEVEL	= 7	; Brown out detector trigger level
                                 
                                 ; HIGH fuse bits
                                 .equ	BOOTRST	= 0	; Select Reset Vector
                                 .equ	BOOTSZ0	= 1	; Select Boot Size
                                 .equ	BOOTSZ1	= 2	; Select Boot Size
                                 .equ	EESAVE	= 3	; EEPROM memory is preserved through chip erase
                                 .equ	CKOPT	= 4	; Oscillator Options
                                 .equ	SPIEN	= 5	; Enable Serial programming and Data Downloading
                                 .equ	JTAGEN	= 6	; Enable JTAG
                                 .equ	OCDEN	= 7	; Enable OCD
                                 
                                 
                                 
                                 ; ***** CPU REGISTER DEFINITIONS *****************************************
                                 .def	XH	= r27
                                 .def	XL	= r26
                                 .def	YH	= r29
                                 .def	YL	= r28
                                 .def	ZH	= r31
                                 .def	ZL	= r30
                                 
                                 
                                 
                                 ; ***** DATA MEMORY DECLARATIONS *****************************************
                                 .equ	FLASHEND	= 0x1fff	; Note: Word address
                                 .equ	IOEND	= 0x003f
                                 .equ	SRAM_START	= 0x0060
                                 .equ	SRAM_SIZE	= 1024
                                 .equ	RAMEND	= 0x045f
                                 .equ	XRAMEND	= 0x0000
                                 .equ	E2END	= 0x01ff
                                 .equ	EEPROMEND	= 0x01ff
                                 .equ	EEADRBITS	= 9
                                 #pragma AVRPART MEMORY PROG_FLASH 16384
                                 #pragma AVRPART MEMORY EEPROM 512
                                 #pragma AVRPART MEMORY INT_SRAM SIZE 1024
                                 #pragma AVRPART MEMORY INT_SRAM START_ADDR 0x60
                                 
                                 
                                 
                                 ; ***** BOOTLOADER DECLARATIONS ******************************************
                                 .equ	NRWW_START_ADDR	= 0x1c00
                                 .equ	NRWW_STOP_ADDR	= 0x1fff
                                 .equ	RWW_START_ADDR	= 0x0
                                 .equ	RWW_STOP_ADDR	= 0x1bff
                                 .equ	PAGESIZE	= 64
                                 .equ	FIRSTBOOTSTART	= 0x1f80
                                 .equ	SECONDBOOTSTART	= 0x1f00
                                 .equ	THIRDBOOTSTART	= 0x1e00
                                 .equ	FOURTHBOOTSTART	= 0x1c00
                                 .equ	SMALLBOOTSTART	= FIRSTBOOTSTART
                                 .equ	LARGEBOOTSTART	= FOURTHBOOTSTART
                                 
                                 
                                 
                                 ; ***** INTERRUPT VECTORS ************************************************
                                 .equ	INT0addr	= 0x0002	; External Interrupt Request 0
                                 .equ	INT1addr	= 0x0004	; External Interrupt Request 1
                                 .equ	OC2addr	= 0x0006	; Timer/Counter2 Compare Match
                                 .equ	OVF2addr	= 0x0008	; Timer/Counter2 Overflow
                                 .equ	ICP1addr	= 0x000a	; Timer/Counter1 Capture Event
                                 .equ	OC1Aaddr	= 0x000c	; Timer/Counter1 Compare Match A
                                 .equ	OC1Baddr	= 0x000e	; Timer/Counter1 Compare Match B
                                 .equ	OVF1addr	= 0x0010	; Timer/Counter1 Overflow
                                 .equ	OVF0addr	= 0x0012	; Timer/Counter0 Overflow
                                 .equ	SPIaddr	= 0x0014	; Serial Transfer Complete
                                 .equ	URXCaddr	= 0x0016	; USART, Rx Complete
                                 .equ	UDREaddr	= 0x0018	; USART Data Register Empty
                                 .equ	UTXCaddr	= 0x001a	; USART, Tx Complete
                                 .equ	ADCCaddr	= 0x001c	; ADC Conversion Complete
                                 .equ	ERDYaddr	= 0x001e	; EEPROM Ready
                                 .equ	ACIaddr	= 0x0020	; Analog Comparator
                                 .equ	TWIaddr	= 0x0022	; 2-wire Serial Interface
                                 .equ	INT2addr	= 0x0024	; External Interrupt Request 2
                                 .equ	OC0addr	= 0x0026	; Timer/Counter0 Compare Match
                                 .equ	SPMRaddr	= 0x0028	; Store Program Memory Ready
                                 
                                 .equ	INT_VECTORS_SIZE	= 42	; size in words
                                 
                                 #endif  /* _M16ADEF_INC_ */
                                 
                                 
                                 ; WW_control.asm
                                 ;
                                 /*
                                    .
                                 */
                                 ; Created: 30.06.2019 11:50:16
                                 ; Author : Asus
                                 ;
                                 
                                 
                                 .def	seconds					=	r0
                                 .def	minutes					=	r1
                                 .def	round					=	r2
                                 .def	sec_work				=	r3
                                 .def	min_work				=	r4
                                 .def	round_work				=	r5
                                 .def	sec_rest				=	r6
                                 .def	min_rest				=	r7
                                 .def	sdi_high_time			=	r8
                                 .def	sdi_low_time			=	r9
                                 .def	sdi_high_data			=	r10
                                 .def	sdi_low_data			=	r11
                                 .def	mbi_clk_counter			=	r12
                                 .def	digit_count				=	r13
                                 .def	set_segm				=	r14
                                 .def	byte_address			=	r15
                                 .def	templ					=	r16
                                 .def	temph					=	r17
                                 .def	temp_2					=	r18
                                 .def	temp_3					=	r19
                                 .def	state_flag				=	r20
                                 .def	status					=	r21
                                 .def	twi_packet_size			=	r22
                                 .def	count					=	r23
                                 .def	t_count					=	r24
                                 .def	enc_state				=	r25
                                 
                                 .equ	WWVM					=	0											//Wall Watch Visual Mode - clock(0) or timer(1) 
                                 .equ	WWSM					=	1											//Wall Watch Set Mode - not set(0) or set (1)
                                 .equ	WWFF					=	2											//Wall Watch Flicking Flag - light on(0) or off(1)
                                 .equ	SDBL					=	3											//Second Digit Bytes Load - first(0) or second(1)
                                 .equ	RPTF					=	4											//Read Packet Timer Flag read (1) or not read(0)
                                 .equ	BTON					=	5											//Boxing Timer ON timer on(1) or off(0)
                                 .equ	BTRT					=	6											//Boxing Timer Rest Time rest(1) or work(0)
                                 .equ	BTPS					=	7											//Boxing Timer PauSe pause(1) or play(0)
                                 .equ	EMPF					=	6											//Encoder Minus Plus Flag - parameter minus(0) or plus(1)
                                 .equ	T2IF					=	7											//Timer2 Interrupt Flag
                                 .equ	BUTTON					=	2
                                 .equ	ENC_PLUS				=	3
                                 .equ	ENC_MINUS				=	4
                                 
                                 .equ	F_CPU					=	16000000
                                 .equ	F_TWI					=	100000
                                 .equ	F_TIMER2_CLK			=	244
                                 .equ	F_TIMER2_BT				=	244
                                 .equ	F_1000Hz				=	1000
                                 .equ	F_400Hz					=	400
                                 .equ	F_TIMER1				=	100000
                                 .equ	OCR0_1000Hz				=	((F_CPU)/(2*256*F_1000Hz))-1
                                 .equ	OCR0_400Hz				=	((F_CPU)/(2*256*F_400Hz))-1
                                 .equ	OCR1_REG				=	((F_CPU)/(F_TIMER1))-1
                                 .equ	BAUD_RATE				=	2400
                                 .equ	TWI_BAUD				=	(F_CPU/(2*F_TWI))-8
                                 .equ	USART_REG				=	(F_CPU/(16*BAUD_RATE))-1
                                 .equ	PRESCALER_2_CLK			=	(LOG2((F_CPU)/(256*F_TIMER2_CLK))) - 2
                                 .equ	PRESCALER_2_BT			=	(LOG2((F_CPU)/(256*F_TIMER2_BT))) - 2
                                 .equ	BT_MAX_TIME				=	1200									//      . 
                                 .equ	PORT_ANODE				=	PORTC
                                 .equ	PORT_CATHODE			=	PORTA
                                 .equ	DDR_ANODE				=	DDRC
                                 .equ	DDR_CATHODE				=	DDRA
                                 .equ	OE						=	1
                                 .equ	CLK						=	3
                                 .equ	LE						=	4
                                 .equ	SDI_TIME				=	2
                                 .equ	SDI_DATA				=	5
                                 
                                 //eeprom
                                 .equ	EEPROM_PAGE_SIZE		=	64
                                 
                                 .org	0
000000 940c 0024                 jmp		reset
                                 .org	OVF2addr
000008 940c 055e                 jmp		Timer2
                                 .org	OC1Aaddr
00000c 940c 05a0                 jmp		Timer1
                                 .org	URXCaddr
000016 940c 05f7                 jmp		UART_RX
                                 .org	UTXCaddr
00001a 940c 05e3                 jmp		UART_TX
                                 .org	TWIaddr
000022 940c 006b                 jmp		TWI_int
                                 
                                 
                                 reset:
                                 //  
000024 e50f                      ldi		templ,LOW(RAMEND)
000025 e014                      ldi		temph,HIGH(RAMEND)
000026 bf0d                      out		SPL,templ
000027 bf1e                      out		SPH,temph
                                 //  2
000028 e70e                      ldi		templ,(1<<COM21) | (1<<COM20) | (1<<WGM21) | (1<<WGM20) | PRESCALER_2_CLK
000029 bd05                      out		TCCR2,templ
00002a e003                      ldi		templ,3
00002b bd03                      out		OCR2,templ
00002c e400                      ldi		templ,(1<<TOIE2)
00002d bf09                      out		TIMSK,templ
                                 // TWI
00002e e408                      ldi		templ,TWI_BAUD
00002f b900                      out		TWBR,templ
000030 2700                      clr		templ
000031 b901                      out		TWSR,templ
                                 // UART
000032 e908                      ldi		templ,(1<<RXCIE) | (1<<RXEN) | (1<<TXEN)// | (1<<TXCIE)
000033 b90a                      out		UCSRB,templ
000034 e806                      ldi		templ,(1<<URSEL) | (1<<UCSZ1) | (1<<UCSZ0)
000035 bd00                      out		UCSRC,templ
000036 e90f                      ldi		templ,LOW(USART_REG)
000037 e011                      ldi		temph,HIGH(USART_REG)
000038 bd10                      out		UBRRH,temph
000039 b909                      out		UBRRL,templ
                                  // ,  - 128,  - 
00003a e600                       ldi	templ,(1<<REFS0) | (1<<ADLAR)
00003b b907                       out	ADMUX,templ
00003c e807                       ldi	templ,(1<<ADEN) | (1<<ADPS2) | (1<<ADPS1) | (1<<ADPS0)
00003d b906                       out	ADCSRA,templ
                                 //  
00003e 9ab8                      sbi		DDRB,0
00003f 9ac0                      sbi		PORTB,0
000040 9abb                      sbi		DDRB,3
000041 9a92                      sbi		PORTD,BUTTON
000042 9a93                      sbi		PORTD,ENC_PLUS
000043 9a94                      sbi		PORTD,ENC_MINUS
000044 9a8f                      sbi		DDRD,7
                                 //sbi		PORTD,7
000045 ef0c                      ldi		templ,0xFC
000046 bb04                      out		DDR_ANODE,templ
000047 e30e                      ldi		templ,(1<<OE) | (1<<CLK) | (1<<LE) | (1<<SDI_TIME) | (1<<SDI_DATA)
000048 bb0a                      out		DDR_CATHODE,templ
                                 //  
000049 9478                      sei
00004a 24ee                      clr		set_segm
00004b 2744                      clr		state_flag
00004c 2788                      clr		t_count
00004d 2400                      clr		seconds
00004e 2411                      clr		minutes
00004f 2422                      clr		round
000050 9423                      inc		round
000051 e000                      ldi		templ,0
000052 2e30                      mov		sec_work,templ
000053 2e60                      mov		sec_rest,templ
000054 e002                      ldi		templ,2
000055 2e40                      mov		min_work,templ
000056 e001                      ldi		templ,1
000057 2e70                      mov		min_rest,templ
000058 e00c                      ldi		templ,12
000059 2e50                      mov		round_work,templ
00005a 940e 06cf                 call	Read_timer_parameters_from_eeprom				;   
00005c 2700                      clr		templ
00005d ebac                      ldi		XL,LOW(RX_HEAD)							; 
00005e e0b0                      ldi		XH,HIGH(RX_HEAD)
00005f 930c                      st		X,templ	
000060 ebcd                      ldi		YL,LOW(RX_TAIL)							; 
000061 e0d0                      ldi		YH,HIGH(RX_TAIL)
000062 8308                      st		Y,templ
                                 
000063 940c 0734                 jmp		program_begin
                                 
                                 .include	"TWI_functions.asm"
                                 
                                      TWI
                                 */
                                 
                                  .equ	DS1307_ADDRESS		=	104
                                  .equ	write				=	0
                                  .equ	read				=	1
                                  .equ	TWSR_MASK			=	0xFC
                                  .equ	TWI_NEED_ANSW		=	(1<<TWEA)
                                  .equ	TWI_NO_NEED_ANSW	=	(0<<TWEA)
                                 //                        
                                  .equ	TWI_START			=	0x08  // START has been transmitted  
                                  .equ	TWI_REP_START		=	0x10  // Repeated START has been transmitted
                                  .equ	TWI_ARB_LOST		=	0x38  // Arbitration lost
                                 
                                 //                         
                                  .equ	TWI_MTX_ADR_ACK     =	0x18  // SLA+W has been tramsmitted and ACK received
                                  .equ	TWI_MTX_ADR_NACK    =	0x20  // SLA+W has been tramsmitted and NACK received 
                                  .equ	TWI_MTX_DATA_ACK    =	0x28  // Data byte has been tramsmitted and ACK received
                                  .equ	TWI_MTX_DATA_NACK   =	0x30  // Data byte has been tramsmitted and NACK received 
                                 
                                 //     
                                  .equ	TWI_MRX_ADR_ACK     =	0x40  // SLA+R has been tramsmitted and ACK received
                                  .equ	TWI_MRX_ADR_NACK    =	0x48  // SLA+R has been tramsmitted and NACK received
                                  .equ	TWI_MRX_DATA_ACK    =	0x50  // Data byte has been received and ACK tramsmitted
                                  .equ	TWI_MRX_DATA_NACK   =	0x58  // Data byte has been received and NACK tramsmitted
                                 
                                 
                                  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                  
                                  //     
                                  Start:
                                  ;   	
000065 b706                      	in		templ,TWCR
000066 fd01                      	sbrc	templ,(1<<TWIE)
000067 cffd                      	rjmp	Start
                                  ;    
000068 ea05                      	ldi		templ,(1<<TWEN)|(1<<TWIE)|(1<<TWINT)|(1<<TWSTA)
000069 bf06                      	out		TWCR,templ
00006a 9508                       ret
                                  
                                  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                  //  TWI   
                                  TWI_int:
00006b 930f                      	push	templ
00006c 931f                      	push	temph	
                                  ;     
00006d b151                      	in		status,TWSR
00006e 7f5c                      	andi	status,TWSR_MASK
                                  ;    ,  ,  
                                  ;          .    
00006f 3058                      	cpi		status,TWI_START
000070 f031                      	breq	tranceive
000071 3150                      	cpi		status,TWI_REP_START
000072 f021                      	breq	tranceive
000073 3158                      	cpi		status,TWI_MTX_ADR_ACK
000074 f011                      	breq	tranceive
000075 3258                      	cpi		status,TWI_MTX_DATA_ACK
000076 f419                      	brne	status_check_1
                                  tranceive:
000077 940e 0094                 	call	Send_byte	
000079 c017                      	rjmp	exit_twi_int 
                                  ;             
                                  ;        ,   
                                  ;       
                                  status_check_1:
00007a 3550                      	cpi		status,TWI_MRX_DATA_ACK
00007b f419                      	brne	receive
00007c 940e 00a5                 	call	Read_byte
00007e c012                      	rjmp	exit_twi_int
                                  receive:
00007f 3450                      	cpi		status,TWI_MRX_ADR_ACK
000080 f421                      	brne	status_check_2
000081 94fa                      	dec		byte_address
000082 ec05                      	ldi		templ,(1<<TWEN)|(1<<TWIE)|(1<<TWINT)|(1<<TWEA)
000083 bf06                      	out		TWCR,templ
000084 c00c                      	rjmp	exit_twi_int 
                                  status_check_2:
                                  ;     -     
000085 3558                      	cpi		status,TWI_MRX_DATA_NACK
000086 f419                      	brne	status_check_3
000087 940e 00a5                 	call	Read_byte
000089 c007                      	rjmp	exit_twi_int 
                                  status_check_3:
                                  ;     
                                  ; 
00008a 3358                      	cpi		status,TWI_ARB_LOST
00008b f419                      	brne	status_check_4
00008c ea05                      	ldi		templ,(1<<TWEN)|(1<<TWIE)|(1<<TWINT)|(1<<TWSTA)
00008d bf06                      	out		TWCR,templ
00008e c002                      	rjmp	exit_twi_int
                                  status_check_4:	
                                  ;   SLA+W    
                                  ;   SLA+R        
                                  ;       
                                  ;   -     
00008f e004                      	ldi		templ,(1<<TWEN)|(0<<TWIE)|(0<<TWINT)|(0<<TWEA)|(0<<TWSTA)|(0<<TWSTO)|(0<<TWWC)	; 
000090 bf06                      	out		TWCR,templ
                                  exit_twi_int:	
000091 911f                      	pop		temph
000092 910f                      	pop		templ
000093 9518                       reti
                                  
                                  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                  //           byte_address
                                  Send_byte:
000094 2366                      	tst		twi_packet_size					;    
000095 f061                      	breq	last_byte
000096 e6c0                      	ldi		YL,LOW(TWI_BUFFER_OUT)			;   ,   -   byte_address
000097 e0d0                      	ldi		YH,HIGH(TWI_BUFFER_OUT)
000098 2700                      	clr		templ
000099 0dcf                      	add		YL,byte_address
00009a 1fd0                      	adc		YH,templ
00009b 8108                      	ld		templ,Y
00009c b903                      	out		TWDR,templ										;      TWI
00009d e805                      	ldi		templ,(1<<TWEN)|(1<<TWIE)|(1<<TWINT)			; 
00009e bf06                      	out		TWCR,templ
00009f 94f3                      	inc		byte_address									;    . 
0000a0 956a                      	dec		twi_packet_size							
0000a1 c002                      	rjmp	exit_send
                                  //    -  
                                  last_byte:
0000a2 e904                      	ldi		templ,(1<<TWEN)|(1<<TWINT)|(1<<TWSTO)|(0<<TWIE)
0000a3 bf06                      	out		TWCR,templ
                                  exit_send:
0000a4 9508                       ret
                                  
                                  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                  //              ,
                                  //    byte_address 
                                  Read_byte:
0000a5 2366                      	tst		twi_packet_size
0000a6 f421                      	brne	not_last_byte_in
0000a7 b113                      	in		temph,TWDR
0000a8 e904                      	ldi		templ,(1<<TWEN)|(1<<TWINT)|(1<<TWSTO)|(0<<TWIE)
0000a9 bf06                      	out		TWCR,templ
0000aa c009                      	rjmp	exit_read
                                  not_last_byte_in:
0000ab 3061                      	cpi		twi_packet_size,1
0000ac f421                      	brne	not_pre_last_byte_in
0000ad b113                      	in		temph,TWDR
0000ae e805                      	ldi		templ,(1<<TWEN)|(1<<TWIE)|(1<<TWINT)|(0<<TWEA)
0000af bf06                      	out		TWCR,templ
0000b0 c003                      	rjmp	exit_read
                                  not_pre_last_byte_in:
0000b1 b113                      	in		temph,TWDR
0000b2 ec05                      	ldi		templ,(1<<TWEN)|(1<<TWIE)|(1<<TWINT)|(1<<TWEA)
0000b3 bf06                      	out		TWCR,templ	
                                  exit_read:
0000b4 e7c0                      	ldi		YL,LOW(TWI_BUFFER_IN)			;   ,    -   byte_address
0000b5 e0d0                      	ldi		YH,HIGH(TWI_BUFFER_IN)
0000b6 2700                      	clr		templ
0000b7 0dcf                      	add		YL,byte_address
0000b8 1fd0                      	adc		YH,templ
0000b9 8318                      	st		Y,temph	
0000ba 956a                      	dec		twi_packet_size
0000bb 94f3                      	inc		byte_address
0000bc 9508                       ret
                                  
                                  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                  //           .
                                  //    ,    - 7.
                                  //      ,   TWI_BUFFER_IN
                                  //     -   0,
                                  //    2  -  -  0 
                                 
                                  Read_packet:
0000bd 2700                      	clr		templ
0000be bb05                      	out		PORT_ANODE,templ
                                 	//   0
0000bf e062                      	ldi		twi_packet_size,2						
0000c0 24ff                      	clr		byte_address
0000c1 e6c0                      	ldi		YL,LOW(TWI_BUFFER_OUT)					;          0
0000c2 e0d0                      	ldi		YH,HIGH(TWI_BUFFER_OUT)	
0000c3 ed00                      	ldi		templ,(DS1307_ADDRESS<<1)|write			; (  )						
0000c4 9309                      	st		Y+,templ
0000c5 2700                      	clr		templ						
0000c6 8308                      	st		Y,templ
0000c7 940e 0065                 	call	Start
0000c9 940e 00d6                 	call	Wait_TWI_finish
                                 	// 
0000cb e068                      	ldi		twi_packet_size,8						;7     1   
0000cc 24ff                      	clr		byte_address							;    
0000cd ed01                      	ldi		templ,(DS1307_ADDRESS<<1)|read			; (  )
0000ce e6c0                      	ldi		YL,LOW(TWI_BUFFER_OUT)					;        
0000cf e0d0                      	ldi		YH,HIGH(TWI_BUFFER_OUT)
0000d0 8308                      	st		Y,templ
0000d1 940e 0065                 	call	Start
0000d3 940e 00d6                 	call	Wait_TWI_finish
0000d5 9508                       ret
                                 
                                  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                  //   TWI
                                  Wait_TWI_finish:
0000d6 b706                      	in		templ,TWCR
0000d7 fd00                      	sbrc	templ,TWIE
0000d8 cffd                      	rjmp	Wait_TWI_finish
0000d9 9508                       ret
                                 
                                  .dseg
                                 
000060                            TWI_BUFFER_OUT:	.byte	16
                                 
000070                            TWI_BUFFER_IN:		.byte	16
                                 
                                  .cseg
                                 .include	"MainFunctions.asm"
                                 
                                      .
                                 1.      .       ,    , 
                                                TWI_BUFFER_IN.       
                                  ,             TEMP_OUTPUT_BUFFER,      
                                 OUTPUT_BUFFER   (            ). 
                                 2.             ,    Z.      
                                  TEMP_OUTPUT_BUFFER +   +    .
                                 3.        .
                                 4.      .       ,     1 ,  
                                    ( ., ., , ,   ..)    .        
                                 ,      TIMER_BUFFER,    OUTPUT_BUFFER.
                                 5.     .    ,        /   
                                 .   ,    ,        .
                                 6.          .     OUTPUT_BUFFER   . 
                                 7.   .
                                 8.    1000 .
                                 9.    400 .
                                 10.     -,      byte_address,     temph.
                                 11.     temph   BCD   HEX.
                                 12.     temph   HEX   BCD.
                                 13.    .
                                 14.    ,        ,     .   
                                    (BT_MAX_TIME),         .
                                 15.     .
                                 
                                 */
                                 
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////	1
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 Clock_mode_proc:
                                 
0000da ff44                      	sbrs	state_flag,RPTF							;        -    
0000db 940c 0144                 	jmp		exit_clock_mode_proc
                                 
                                 	//           
0000dd ff42                      	sbrs	state_flag,(1<<WWSM)
0000de 940c 00ec                 	jmp		do_not_clear_set_mode_counter
0000e0 ebab                      	ldi		XL,LOW(SET_MODE_COUNTER)				
0000e1 e0b0                      	ldi		XH,HIGH(SET_MODE_COUNTER)
0000e2 910c                      	ld		templ,X
0000e3 9503                      	inc		templ
0000e4 3f0a                      	cpi		templ,250
0000e5 f018                      	brlo	write_set_mode_counter
0000e6 7f4d                      	cbr		state_flag,(1<<WWSM)
0000e7 9ac0                      	sbi		PORTB,0
0000e8 2700                      	clr		templ
                                 write_set_mode_counter:
0000e9 ebab                      	ldi		XL,LOW(SET_MODE_COUNTER)				
0000ea e0b0                      	ldi		XH,HIGH(SET_MODE_COUNTER)
0000eb 930c                      	st		X,templ
                                 do_not_clear_set_mode_counter:
                                 
                                 ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
0000ec 7e4f                      	cbr		state_flag,(1<<RPTF)
0000ed 940e 00bd                 	call	Read_packet								;   DS1307,     TWI_BUFFER_IN
0000ef 940e 0699                 	call	Correct_time
                                 
0000f1 2777                      	clr		count									;  
                                 
                                 next_ds1307_byte:
                                 	
0000f2 2700                      	clr		templ									;     TWI_BUFFER_IN + count
0000f3 e7a0                      	ldi		XL,LOW(TWI_BUFFER_IN)
0000f4 e0b0                      	ldi		XH,HIGH(TWI_BUFFER_IN)
0000f5 0fa7                      	add		XL,count
0000f6 1fb0                      	adc		XH,templ
0000f7 910c                      	ld		templ,X
                                 	
0000f8 2f10                      	mov		temph,templ								;   -    
0000f9 700f                      	andi	templ,0xF								;   ,  -  
0000fa 7f10                      	andi	temph,0xF0
0000fb 9512                      	swap	temph
                                 
0000fc 3073                      	cpi		count,3									;  count -  ,    
0000fd f424                      	brge	data_bytes_format
0000fe ede6                      	ldi		ZL,LOW(2*TIME_DIGIT_CATHODE)			;   (. - 0, . - 1,  - 2) -    
0000ff e0f5                      	ldi		ZH,HIGH(2*TIME_DIGIT_CATHODE)
000100 940c 010d                 	jmp		set_XY_reg
                                 data_bytes_format:
000102 3073                      	cpi		count,3
000103 f021                      	breq	data_letter_format
000104 e0ec                      	ldi		ZL,LOW(2*DATA_DIGIT_CATHODE)			;4-  5-  -    ( - 4,  - 5)
000105 e0f6                      	ldi		ZH,HIGH(2*DATA_DIGIT_CATHODE)
000106 940c 010d                 	jmp		set_XY_reg
                                 data_letter_format:
000108 0f00                      	lsl		templ									;       templ  temph  
000109 2f10                      	mov		temph,templ								;templ   2, temph  1  templ	
00010a 9513                      	inc		temph
00010b eeec                      	ldi		ZL,LOW(2*DATA_LETTER_CATHODE)			;3- -     (4)
00010c e0f5                      	ldi		ZH,HIGH(2*DATA_LETTER_CATHODE)
                                 set_XY_reg:
00010d 2fae                      	mov		XL,ZL									;     
00010e 2fbf                      	mov		XH,ZH
00010f 2722                      	clr		temp_2
000110 2f37                      	mov		temp_3,count
000111 0f33                      	lsl		temp_3									; count  4 
000112 0f33                      	lsl		temp_3
000113 e8c0                      	ldi		YL,LOW(TEMP_OUTPUT_BUFFER)				;       
000114 e0d0                      	ldi		YH,HIGH(TEMP_OUTPUT_BUFFER)
000115 0fc3                      	add		YL,temp_3								;       -     4 + TEMP_OUTPUT_BUFFER
000116 1fd2                      	adc		YH,temp_2
                                 								
000117 0f00                      	lsl		templ									;         templ
000118 0fe0                      	add		ZL,templ								
000119 1ff2                      	adc		ZH,temp_2
00011a 940e 0145                 	call	Get_output	
                                 
00011c 2fea                      	mov		ZL,XL
00011d 2ffb                      	mov		ZH,XH
00011e 2722                      	clr		temp_2
00011f 0f11                      	lsl		temph
000120 0fe1                      	add		ZL,temph								;         temph
000121 1ff2                      	adc		ZH,temp_2
000122 940e 0145                 	call	Get_output
                                 
000124 9573                      	inc		count									;       6  
000125 3076                      	cpi		count,6
000126 f414                      	brge	copy_output_buffers
000127 940c 00f2                 	jmp		next_ds1307_byte
                                 
                                 //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 copy_output_buffers:
000129 e8a0                      	ldi		XL,LOW(TEMP_OUTPUT_BUFFER)				;          
00012a e0b0                      	ldi		XH,HIGH(TEMP_OUTPUT_BUFFER)
00012b e9c8                      	ldi		YL,LOW(OUTPUT_BUFFER)
00012c e0d0                      	ldi		YH,HIGH(OUTPUT_BUFFER)
00012d 94f8                      	cli
00012e 2777                      	clr		count
                                 start_copy_bytes:	
00012f 940e 016d                 	call	Copy_output_bytes
000131 3170                      	cpi		count,16
000132 f3e0                      	brlo	start_copy_bytes						;        
                                 
000133 2700                      	clr		templ
000134 e014                      	ldi		temph,4
000135 0fc1                      	add		YL,temph
000136 1fd0                      	adc		YH,templ
                                 next_data_byte:
000137 940e 016d                 	call	Copy_output_bytes
000139 3174                      	cpi		count,20
00013a f3e0                      	brlo	next_data_byte
                                 
00013b 2700                      	clr		templ
00013c e018                      	ldi		temph,8
00013d 1bc1                      	sub		YL,temph
00013e 0bd0                      	sbc		YH,templ
                                 next_month_byte:
00013f 940e 016d                 	call	Copy_output_bytes
000141 3178                      	cpi		count,24
000142 f3e0                      	brlo	next_month_byte
                                 
000143 9478                      	sei
                                 
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 /*	clr		count
                                 	ldi		templ,0xFF
                                 	call	Send_UART*/
                                 
                                 exit_clock_mode_proc:
000144 9508                      ret
                                 
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////	2
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 
                                 
                                 Get_output:	
000145 ff43                      	sbrs	state_flag,SDBL							;       SDBL (0 -  , 1 - )
000146 940c 014e                 	jmp		check_set_mode
                                 	
000148 3072                      	cpi		count,2									;      (count=2)    (count=4)  ,     (temp_2=temp_3=0)
000149 f011                      	breq	check_second_digit
00014a 3074                      	cpi		count,4
00014b f411                      	brne	check_set_mode	
                                 check_second_digit:
00014c 3010                      	cpi		temph,0
00014d f041                      	breq	clr_output_bytes
                                 
                                 check_set_mode:
00014e ff41                      	sbrs	state_flag,WWSM							;    
00014f 940c 015a                 	jmp		read_programm_memory
000151 157e                      	cp		count,set_segm
000152 f439                      	brne	read_programm_memory					;  ,           
000153 ff42                      	sbrs	state_flag,WWFF
000154 940c 015a                 	jmp		read_programm_memory					;   -  WWFF=1,     ,  
                                 clr_output_bytes:
000156 2722                      	clr		temp_2
000157 2733                      	clr		temp_3
000158 940c 0163                 	jmp		write_to_output_buffer
                                 
                                 read_programm_memory:								;   
00015a 9124                      	lpm		temp_2,Z
00015b 9631                      	adiw	ZL,1
00015c 9134                      	lpm		temp_3,Z
                                 
00015d 3074                      	cpi		count,4									;         
00015e f421                      	brne	write_to_output_buffer
00015f fd43                      	sbrc	state_flag,SDBL							
000160 940c 0163                 	jmp		write_to_output_buffer
000162 6820                      	ori		temp_2,0x80
                                 
                                 write_to_output_buffer:								;   
                                 
000163 9329                      	st		Y+,temp_2
000164 9339                      	st		Y+,temp_3
                                 
000165 fd43                      	sbrc	state_flag,SDBL							;  SDBL
000166 940c 016b                 	jmp		clear_sdbl_flag
000168 6048                      	sbr		state_flag,(1<<SDBL)
000169 940c 016c                 	jmp		exit_get_output_proc
                                 clear_sdbl_flag:
00016b 7f47                      	cbr		state_flag,(1<<SDBL)
                                 	
                                 exit_get_output_proc:
00016c 9508                      ret
                                 
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////	3
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 
                                 Copy_output_bytes:
00016d 910d                      	ld		templ,X+
00016e 9309                      	st		Y+,templ
00016f 9573                      	inc		count
000170 9508                      ret
                                 
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////	4
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 Timer_mode_proc:
000171 ff44                      	sbrs	state_flag,RPTF							;       -       
000172 940c 0144                 	jmp		exit_clock_mode_proc
000174 7e4f                      	cbr		state_flag,(1<<RPTF)
                                 
000175 940e 017a                 	call	Update_BT_counter						;   
000177 940e 021f                 	call	Get_output_timer_mode					;      
000179 9508                      ret
                                 
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////	5
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 Update_BT_counter:
00017a ff45                      	sbrs	state_flag,BTON							;   (/,  /)				
00017b 940c 01de                 	jmp		timer_is_off
00017d fd47                      	sbrc	state_flag,BTPS
00017e 940c 01f1                 	jmp		timer_pause
                                 	
                                 ////////////////////////////////////////////////
000180 940e 02e5                 	call	Clear_timer_mode_counter				;    
000182 9403                      	inc		seconds									;  
                                 
000183 2711                      	clr		temph									;       
000184 e004                      	ldi		templ,4
000185 1611                      	cp		minutes,temph
000186 f431                      	brne	check_next_minute
000187 1600                      	cp		seconds,templ
000188 f421                      	brne	check_next_minute
000189 940e 0278                 	call	Sound_OFF								;      -  
00018b 940c 0192                 	jmp		check_rest_work_1
                                 
                                 check_next_minute:									;    
00018d e30c                      	ldi		templ,60
00018e 1600                      	cp		seconds,templ
00018f f411                      	brne	check_rest_work_1						;    60 -       
000190 2400                      	clr		seconds
000191 9413                      	inc		minutes
                                 
                                 check_rest_work_1:									;   
000192 fd46                      	sbrc	state_flag,BTRT
000193 940c 01aa                 	jmp		rest_time_1		
                                 	
000195 1414                      	cp		minutes,min_work						;    
000196 f479                      	brne	fill_buffer_var_1_temp
000197 1403                      	cp		seconds,sec_work
000198 f469                      	brne	fill_buffer_var_1_temp
000199 940e 027c                 	call	Sound_1000Hz_ON							;       ,         
00019b 2400                      	clr		seconds
00019c 2411                      	clr		minutes
00019d 6440                      	sbr		state_flag,(1<<BTRT)
00019e 1425                      	cp		round,round_work
00019f f441                      	brne	fill_buffer_var_2_temp
0001a0 7d4f                      	cbr		state_flag,(1<<BTON)					;   -  
0001a1 2422                      	clr		round
0001a2 9423                      	inc		round
0001a3 6840                      	sbr		state_flag,(1<<BTPS)
0001a4 940c 020c                 	jmp		fill_buffer_var_3
                                 
                                 fill_buffer_var_1_temp:
0001a6 940c 01f8                 	jmp		fill_buffer_var_1
                                 fill_buffer_var_2_temp:
0001a8 940c 0202                 	jmp		fill_buffer_var_2
                                 
                                 
                                 rest_time_1:										;      
0001aa 1417                      	cp		minutes,min_rest						;       1000(3       ) 
0001ab f451                      	brne	rest_seconds_set_zero					; 400 ( 6,4  2 .     1 .) 
0001ac 1406                      	cp		seconds,sec_rest
0001ad f4c9                      	brne	check_400Hz_on	
0001ae 940e 027c                 	call	Sound_1000Hz_ON
0001b0 2411                      	clr		minutes
0001b1 2400                      	clr		seconds
0001b2 7b4f                      	cbr		state_flag,(1<<BTRT)
0001b3 9423                      	inc		round
0001b4 940c 01f8                 	jmp		fill_buffer_var_1
                                 
                                 rest_seconds_set_zero:								;   ,       
0001b6 2066                      	tst		sec_rest
0001b7 f479                      	brne	check_400Hz_on
0001b8 2d07                      	mov		templ,min_rest
0001b9 950a                      	dec		templ
0001ba 1610                      	cp		minutes,templ
0001bb f4b9                      	brne	set_sound_off
0001bc e306                      	ldi		templ,54
0001bd 1600                      	cp		seconds,templ
0001be f0d9                      	breq	set_sound_400Hz_on
0001bf e308                      	ldi		templ,56
0001c0 1600                      	cp		seconds,templ
0001c1 f0c1                      	breq	set_sound_400Hz_on
0001c2 e30a                      	ldi		templ,58
0001c3 1600                      	cp		seconds,templ
0001c4 f0a9                      	breq	set_sound_400Hz_on
0001c5 940c 01d3                 	jmp		set_sound_off
                                 
                                 check_400Hz_on:											;   ,        
0001c7 2d06                      	mov		templ,sec_rest
0001c8 5002                      	subi	templ,2
0001c9 1600                      	cp		seconds,templ
0001ca f079                      	breq	set_sound_400Hz_on
0001cb 5002                      	subi	templ,2
0001cc 1600                      	cp		seconds,templ
0001cd f061                      	breq	set_sound_400Hz_on
0001ce 5002                      	subi	templ,2
0001cf 1600                      	cp		seconds,templ
0001d0 f049                      	breq	set_sound_400Hz_on
0001d1 940c 01d3                 	jmp		set_sound_off	
                                 	
                                 set_sound_off:
0001d3 e004                      	ldi		templ,4
0001d4 1600                      	cp		seconds,templ
0001d5 f160                      	brlo	fill_buffer_var_2
0001d6 940e 0278                 	call	Sound_OFF
0001d8 940c 0202                 	jmp		fill_buffer_var_2
                                 
                                 set_sound_400Hz_on:
0001da 940e 0282                 	call	Sound_400Hz_ON
0001dc 940c 0202                 	jmp		fill_buffer_var_2
                                 
                                 
                                 
                                 ////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 timer_is_off:
                                 	//call	Increment_timer_mode_counter					;    
0001de fd46                      	sbrc	state_flag,BTRT
0001df 940c 01e5                 	jmp		timer_just_stopped	
0001e1 940e 0278                 	call	Sound_OFF
0001e3 940c 01ec                 	jmp		check_timer_set_mode
                                 
                                 timer_just_stopped:
0001e5 ff47                      	sbrs	state_flag,BTPS
0001e6 940c 01eb                 	jmp		set_btrt_to_zero
0001e8 774f                      	cbr		state_flag,(1<<BTPS)
0001e9 940c 01ec                 	jmp		check_timer_set_mode
                                 set_btrt_to_zero:
0001eb 7b4f                      	cbr		state_flag,(1<<BTRT)
                                 check_timer_set_mode:
0001ec ff41                      	sbrs	state_flag,WWSM
0001ed 940c 020c                 	jmp		fill_buffer_var_3	
0001ef 940c 0216                 	jmp		fill_buffer_var_4
                                 
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 timer_pause:
                                 	//call	Increment_timer_mode_counter					;    
0001f1 940e 0278                 	call	Sound_OFF
0001f3 ff46                      	sbrs	state_flag,BTRT
0001f4 940c 01f8                 	jmp		fill_buffer_var_1
0001f6 940c 0202                 	jmp		fill_buffer_var_2
                                 
                                 	
                                 fill_buffer_var_1:									;      (   )			
0001f8 eba0                      	ldi		XL,LOW(TIMER_BUFFER)
0001f9 e0b0                      	ldi		XH,HIGH(TIMER_BUFFER)
0001fa 920d                      	st		X+,seconds
0001fb 921d                      	st		X+,minutes
0001fc 922d                      	st		X+,round
0001fd 925d                      	st		X+,round_work
0001fe 923d                      	st		X+,sec_work
0001ff 924c                      	st		X,min_work
000200 940c 021e                 	jmp		exit_bt_counter_procedure
                                 
                                 fill_buffer_var_2:
000202 eba0                      	ldi		XL,LOW(TIMER_BUFFER)
000203 e0b0                      	ldi		XH,HIGH(TIMER_BUFFER)
000204 920d                      	st		X+,seconds
000205 921d                      	st		X+,minutes
000206 922d                      	st		X+,round
000207 925d                      	st		X+,round_work
000208 926d                      	st		X+,sec_rest
000209 927c                      	st		X,min_rest
00020a 940c 021e                 	jmp		exit_bt_counter_procedure
                                 
                                 fill_buffer_var_3:
00020c eba0                      	ldi		XL,LOW(TIMER_BUFFER)
00020d e0b0                      	ldi		XH,HIGH(TIMER_BUFFER)
00020e 920d                      	st		X+,seconds
00020f 921d                      	st		X+,minutes
000210 922d                      	st		X+,round
000211 925d                      	st		X+,round_work
000212 923d                      	st		X+,sec_work
000213 924c                      	st		X,min_work
000214 940c 021e                 	jmp		exit_bt_counter_procedure
                                 
                                 fill_buffer_var_4:
000216 eba0                      	ldi		XL,LOW(TIMER_BUFFER)
000217 e0b0                      	ldi		XH,HIGH(TIMER_BUFFER)
000218 923d                      	st		X+,sec_work
000219 924d                      	st		X+,min_work
00021a 925d                      	st		X+,round_work
00021b 925d                      	st		X+,round_work
00021c 926d                      	st		X+,sec_rest
00021d 927c                      	st		X,min_rest
                                 
                                 exit_bt_counter_procedure:	
00021e 9508                      ret
                                 
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////	6
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 Get_output_timer_mode:
00021f 2777                      	clr		count
                                 
                                 next_timer_digit_code:
000220 2711                      	clr		temph											;  templ      TIMER_BUFFER + count
000221 eba0                      	ldi		XL,LOW(TIMER_BUFFER)
000222 e0b0                      	ldi		XH,HIGH(TIMER_BUFFER)
000223 0fa7                      	add		XL,count
000224 1fb1                      	adc		XH,temph
000225 910c                      	ld		templ,X
                                 
                                 timer_subtract_ten:											; templ   ,   ,  temph -   
000226 300a                      	cpi		templ,10
000227 f020                      	brlo	timer_check_digit_count
000228 9513                      	inc		temph
000229 500a                      	subi	templ,10
00022a 940c 0226                 	jmp		timer_subtract_ten
                                 
                                 timer_check_digit_count:									;  Z    ,     
00022c 3073                      	cpi		count,3
00022d f420                      	brsh	timer_small_digit_address
00022e ede6                      	ldi		ZL,LOW(2*TIME_DIGIT_CATHODE)					;  
00022f e0f5                      	ldi		ZH,HIGH(2*TIME_DIGIT_CATHODE)
000230 940c 0234                 	jmp		timer_copy_address
                                 
                                 timer_small_digit_address:
000232 e0ec                      	ldi		ZL,LOW(2*DATA_DIGIT_CATHODE)					;  
000233 e0f6                      	ldi		ZH,HIGH(2*DATA_DIGIT_CATHODE)	
                                 
                                 timer_copy_address:											;              
000234 2fae                      	mov		XL,ZL
000235 2fbf                      	mov		XH,ZH
                                 	
000236 2733                      	clr		temp_3											;  Y ,        
000237 2f27                      	mov		temp_2,count									;    count ( )
000238 0f22                      	lsl		temp_2
000239 0f22                      	lsl		temp_2
00023a e9c8                      	ldi		YL,LOW(OUTPUT_BUFFER)
00023b e0d0                      	ldi		YH,HIGH(OUTPUT_BUFFER)
00023c 0fc2                      	add		YL,temp_2
00023d 1fd3                      	adc		YH,temp_3
                                 	
00023e 0f00                      	lsl		templ											;    
00023f 0fe0                      	add		ZL,templ
000240 1ff3                      	adc		ZH,temp_3
                                 
                                 timer_get_ouput_data:
000241 ff43                      	sbrs	state_flag,SDBL									;          , ..    = 0 
000242 940c 024a                 	jmp		timer_first_byte_load							;,      = 0,      
000244 3070                      	cpi		count,0											; -   ( 0  4)
000245 f021                      	breq	timer_first_byte_load
000246 3074                      	cpi		count,4
000247 f011                      	breq	timer_first_byte_load
000248 3010                      	cpi		temph,0
000249 f041                      	breq	timer_clear_output_bytes
                                 
                                 timer_first_byte_load:
00024a ff41                      	sbrs	state_flag,WWSM
00024b 940c 0256                 	jmp		timer_load_output_bytes
00024d 157e                      	cp		count,set_segm
00024e f439                      	brne	timer_load_output_bytes
00024f ff42                      	sbrs	state_flag,WWFF
000250 940c 0256                 	jmp		timer_load_output_bytes
                                 
                                 timer_clear_output_bytes:
000252 2722                      	clr		temp_2
000253 2733                      	clr		temp_3
000254 940c 0263                 	jmp		put_regs_to_output_buffer
                                 
                                 timer_load_output_bytes:
000256 9125                      	lpm		temp_2,Z+
000257 9134                      	lpm		temp_3,Z
000258 3072                      	cpi		count,2											;     (2- )
000259 f419                      	brne	tm_get_output_set_point
00025a 7f27                      	andi	temp_2,0xF7	
00025b 940c 0263                 	jmp		put_regs_to_output_buffer
                                 	
                                 tm_get_output_set_point:
00025d 3075                      	cpi		count,5									;         
00025e f421                      	brne	put_regs_to_output_buffer
00025f fd43                      	sbrc	state_flag,SDBL							
000260 940c 0263                 	jmp		put_regs_to_output_buffer
000262 6820                      	ori		temp_2,0x80					
                                 
                                 put_regs_to_output_buffer:									;       temph
000263 9329                      	st		Y+,temp_2
000264 9339                      	st		Y+,temp_3
000265 fd43                      	sbrc	state_flag,SDBL									;        
000266 940c 0271                 	jmp		timer_clear_sdbl
000268 6048                      	sbr		state_flag,(1<<SDBL)							
000269 2fea                      	mov		ZL,XL
00026a 2ffb                      	mov		ZH,XH
00026b 0f11                      	lsl		temph
00026c 2722                      	clr		temp_2
00026d 0fe1                      	add		ZL,temph
00026e 1ff2                      	adc		ZH,temp_2
00026f 940c 0241                 	jmp		timer_get_ouput_data
                                 
                                 timer_clear_sdbl:
000271 7f47                      	cbr		state_flag,(1<<SDBL)					;                6 
000272 9573                      	inc		count
000273 3076                      	cpi		count,6
000274 f410                      	brsh	exit_get_output_timer_mode
000275 940c 0220                 	jmp		next_timer_digit_code
                                 
                                 exit_get_output_timer_mode:
                                 /*	clr		count
                                 	ldi		templ,0xCC
                                 	call	Send_UART*/
000277 9508                      ret
                                 
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////	7
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 Sound_OFF:
000278 9ac0                      	sbi		PORTB,0
000279 2700                      	clr		templ
00027a bf03                      	out		TCCR0,templ
00027b 9508                      ret
                                 
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////	8
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 Sound_1000Hz_ON:
00027c 98c0                      	cbi		PORTB,0
00027d e10b                      	ldi		templ,(1<<CS00) | (1<<CS01) | (1<<WGM01) | (1<<COM00)
00027e bf03                      	out		TCCR0,templ
00027f e10e                      	ldi		templ,OCR0_1000Hz
000280 bf0c                      	out		OCR0,templ
000281 9508                      ret
                                 
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////	9
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 Sound_400Hz_ON:
000282 98c0                      	cbi		PORTB,0
000283 e10c                      	ldi		templ,(1<<CS02) | (1<<WGM01) | (1<<COM00)
000284 bf03                      	out		TCCR0,templ
000285 e40d                      	ldi		templ,OCR0_400Hz
000286 bf0c                      	out		OCR0,templ
000287 9508                      ret
                                  
                                 //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////							10
                                 //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 Write_byte_to_DS1307:
000288 e063                      	ldi		twi_packet_size,3
000289 2700                      	clr		templ
00028a e6c0                      	ldi		YL,LOW(TWI_BUFFER_OUT)			
00028b e0d0                      	ldi		YH,HIGH(TWI_BUFFER_OUT)
00028c 0dcf                      	add		YL,byte_address
00028d 1fd0                      	adc		YH,templ
00028e ed00                      	ldi		templ,(DS1307_ADDRESS<<1)|write
00028f 9309                      	st		Y+,templ
000290 2d0f                      	mov		templ,byte_address
000291 9309                      	st		Y+,templ
000292 2f01                      	mov		templ,temph
000293 8308                      	st		Y,templ	
000294 940e 0065                 	call	Start
000296 940e 00d6                 	call	Wait_TWI_finish
000298 9508                      ret
                                  
                                 //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////							11
                                 //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 BCD_TO_HEX:
000299 2f01                      	mov		templ,temph
00029a 701f                      	andi	temph,0xF
00029b 7f00                      	andi	templ,0xF0
00029c 9502                      	swap	templ										; temph - , templ - 							
                                 next_increment:
00029d 2300                      	tst		templ
00029e f021                      	breq	exit_bcd_to_hex
00029f 5f16                      	subi	temph,-10
0002a0 950a                      	dec		templ
0002a1 940c 029d                 	jmp		next_increment
                                 exit_bcd_to_hex:	
0002a3 9508                      ret
                                  
                                 //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////							12
                                 //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 HEX_TO_BCD:
0002a4 2700                      	clr		templ
0002a5 3614                      	cpi		temph,100									//     100,    
0002a6 f440                      	brsh	exit_change_format
                                 next_decrement:											//   10      ,  - temph,  - templ
0002a7 301a                      	cpi		temph,10									//  temph		
0002a8 f020                      	brlo	next_format_operation
0002a9 501a                      	subi	temph,10
0002aa 9503                      	inc		templ
0002ab 940c 02a7                 	jmp		next_decrement
                                 next_format_operation:	
0002ad 9502                      	swap	templ										// 4  temph    4  templ
0002ae 2b10                      	or		temph,templ
                                 exit_change_format:	
0002af 9508                      ret
                                  
                                 //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////							13
                                 //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 Set_default_time:
0002b0 e6c0                      	 ldi	YL,LOW(TWI_BUFFER_OUT)			
0002b1 e0d0                      	 ldi	YH,HIGH(TWI_BUFFER_OUT)
0002b2 ed00                      	 ldi	templ,(DS1307_ADDRESS<<1)|write
0002b3 9309                      	 st		Y+,templ
0002b4 e000                      	 ldi	templ,0
0002b5 9309                      	 st		Y+,templ	
0002b6 e000                      	 ldi	templ,0
0002b7 9309                      	 st		Y+,templ	
0002b8 e000                      	 ldi	templ,0
0002b9 9309                      	 st		Y+,templ
0002ba e106                      	 ldi	templ,0x16
0002bb 9309                      	 st		Y+,templ
0002bc e007                      	 ldi	templ,0x7
0002bd 9309                      	 st		Y+,templ	
0002be e201                      	 ldi	templ,0x21
0002bf 9309                      	 st		Y+,templ	
0002c0 e007                      	 ldi	templ,0x7
0002c1 9309                      	 st		Y+,templ
0002c2 e109                      	 ldi	templ,0x19
0002c3 8308                      	 st		Y,templ	
0002c4 e069                      	 ldi	twi_packet_size,9
0002c5 24ff                      	 clr	byte_address
0002c6 940e 0065                 	 call	Start
0002c8 940e 00d6                 	 call	Wait_TWI_finish
0002ca 9508                      ret
                                 
                                 Start_time:
0002cb 940e 00bd                 	call	Read_packet
0002cd e7a0                      	ldi		XL,LOW(TWI_BUFFER_IN)
0002ce e0b0                      	ldi		XH,HIGH(TWI_BUFFER_IN)
0002cf 910c                      	ld		templ,X
0002d0 3800                      	cpi		templ,0x80
0002d1 f411                      	brne	exit_start_time
0002d2 940e 02b0                 	call	Set_default_time
                                 exit_start_time:
0002d4 9508                      ret
                                  
                                 //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////							14
                                 //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 Increment_timer_mode_counter:
                                 //  
0002d5 eba6                      	ldi		XL,LOW(TIMER_MODE_COUNTER)				
0002d6 e0b0                      	ldi		XH,HIGH(TIMER_MODE_COUNTER)
0002d7 910d                      	ld		templ,X+
0002d8 911c                      	ld		temph,X
                                 //  1
0002d9 e021                      	ldi		temp_2,1
0002da 2733                      	clr		temp_3
0002db 0f02                      	add		templ,temp_2
0002dc 1f13                      	adc		temph,temp_3
                                 
                                 //       . 
0002dd 3014                      	cpi		temph,HIGH(BT_MAX_TIME)
0002de f028                      	brlo	exit_increment_timer_mode_counter
0002df 3b00                      	cpi		templ,LOW(BT_MAX_TIME)
0002e0 f018                      	brlo	exit_increment_timer_mode_counter
                                 //      	
0002e1 7f4e                      	cbr		state_flag,(1<<WWVM)
0002e2 940e 02e5                 	call	Clear_timer_mode_counter
                                 
                                 exit_increment_timer_mode_counter:
0002e4 9508                      ret
                                  
                                 //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////							15
                                 //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 
                                 Clear_timer_mode_counter:
                                 
0002e5 2700                      	clr		templ
0002e6 eba6                      	ldi		XL,LOW(TIMER_MODE_COUNTER)				
0002e7 e0b0                      	ldi		XH,HIGH(TIMER_MODE_COUNTER)
0002e8 930d                      	st		X+,templ
0002e9 930c                      	st		X,templ
                                 
0002ea 9508                      ret
                                 
                                 .dseg
                                 
000080                           TEMP_OUTPUT_BUFFER:		.byte	24
                                 
000098                           OUTPUT_BUFFER:			.byte	24
                                 
0000b0                           TIMER_BUFFER:			.byte	6
                                 
0000b6                           TIMER_MODE_COUNTER:		.byte	2
                                 
                                 .cseg
                                 
                                 TIME_DIGIT_CATHODE:
0002eb 0bff
0002ec 0b09
0002ed 0def
0002ee 0fcf
0002ef 0f1d
0002f0 07df
0002f1 07ff                      		.db		0xFF,	0x0B,	0x09,	0x0B,	0xEF,	0x0D,	0xCF,	0x0F,	0x1D,	0x0F,	0xDF,	0x07,	0xFF,	0x07
                                 //						0////			1////			2////			3////			4////			5////			6///
0002f2 0b0f
0002f3 0fff
0002f4 0fdf
0002f5 0000                      		.db		0x0F,	0x0B,	0xFF,	0x0F,	0xDF,	0x0F,	0x00,	0x00
                                 //						7////			8////			9////			NA////
                                 
                                 DATA_LETTER_CATHODE:
0002f6 0000
0002f7 0000
0002f8 9031
0002f9 4b03
0002fa a020
0002fb 2f72                      		.db		0x00,	0x00,	0x00,	0x00,	0x31,	0x90,	0x03,	0x4B,	0x20,	0xA0,	0x72,	0x2F
                                 //						NL///			NL///			////			////			////			////			
0002fc 9031
0002fd 4351
0002fe a020
0002ff e420
000300 a020
000301 4b03
000302 9231
000303 4351
000304 8011
000305 2f72                      		.db		0x31,	0x90,	0x51,	0x43,	0x20,	0xA0,	0x20,	0xE4,	0x20,	0xA0,	0x03,	0x4B,	0x31,	0x92,	0x51,	0x43,	0x11,	0x80,	0x72,	0x2F
                                 //						///			///			////			////			////			////			////			////			///			///			
                                 
                                 DATA_DIGIT_CATHODE:
000306 4b53
000307 0802
000308 ab51
000309 ab52
00030a e802
00030b e352
00030c e353                      		.db		0x53,	0x4B,	0x02,	0x08,	0x51,	0xAB,	0x52,	0xAB,	0x02,	0xE8,	0x52,	0xE3,	0x53,	0xE3
                                 //						0////			1////			2////			3////			4////			5////			6///
00030d 0b02
00030e eb53
00030f eb52
000310 0000                      		.db		0x02,	0x0B,	0x53,	0xEB,	0x52,	0xEB,	0x00,	0x00
                                 //						7////			8////			9////			NA////
                                 
                                 
                                 
                                 .include	"EncoderFunctions.asm"
                                 
                                       .
                                 1.     .   .                                     (    - 0)  
                                   8    ,      1 (                                     ).    ( 
                                   - 1)   8                                          .    0,   
                                    .    500 (    2 ),                                       , 
                                  .     500    ( 2                                  )  ,   .
                                           .                                      (.. 
                                      -     ),                                         .
                                                                                  
                                 enc_state (  ).
                                 2.     .                                            , 
                                    eeprom. 
000311 ff97                      3.     . 
000312 940c 0363                 4.       .
                                 */
000314 2f09                      
000315 7093                      /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
000316 710c                      //////////	1
000317 9506                      /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
000318 9506                      
000319 2f10                      Encoder_proc:
00031a 9516                      	sbrs	enc_state,T2IF
00031b 7001                      	jmp		exit_enc_proc
                                 
00031c eba8                      	mov		templ,enc_state						; enc_state    ,      00031d e0b0                        
00031e 912c                      	andi	enc_state,3							; enc_state     ,  templ -    
00031f 0f22                      	andi	templ,0x1C							; temph -      
000320 2b02                      	lsr		templ
000321 930c                      	lsr		templ
                                 	mov		temph,templ
000322 ebc9                      	lsr		temph
000323 e0d0                      	andi	templ,1
000324 91a9                      
000325 81b8                      	ldi		XL,LOW(BUTTON_STATE)				;                                            1 
000326 3000                      	ldi		XH,HIGH(BUTTON_STATE)
000327 f439                      	ld		temp_2,X
000328 9611                      	lsl		temp_2
000329 ebc9                      	or		templ,temp_2
00032a e0d0                      	st		X,templ
00032b 93a9                      
00032c 83b8                      	ldi		YL,LOW(BUTTON_COUNT)				;        
00032d 940c 0345                 	ldi		YH,HIGH(BUTTON_COUNT)
                                 	ld		XL,Y+
                                 	ld		XH,Y
00032f 3f0f                      
000330 f4a1                      	cpi		templ,0								;     1     8  (  000331 30a0                         = 0)
000332 f421                      	brne	check_button_state_unpress			;    8 ,    
000333 30b0                      	adiw	XL,1								;  ,           000334 f411                      
000335 940c 0345                 	ldi		YL,LOW(BUTTON_COUNT)				;   512(  2-    2)                                      -     	
                                 	ldi		YH,HIGH(BUTTON_COUNT)				;  512,     -    000337 30b2                       
000338 f424                      	st		Y+,XL
000339 940e 0364                 	st		Y,XH
00033b 940c 033f                 	jmp		check_encoder_state
                                 
                                 check_button_state_unpress:
00033d 940e 03b2                 	cpi		templ,0xFF
                                 	brne	check_encoder_state
                                 	cpi		XL,0
00033f 27aa                      	brne	check_non_zero_counter
000340 27bb                      	cpi		XH,0
000341 ebc9                      	brne	check_non_zero_counter
000342 e0d0                      	jmp		check_encoder_state
000343 93a9                      
000344 83b8                      check_non_zero_counter:
                                 	cpi		XH,2
                                 	brge	button_counter_more_than_512
000345 3013                      	call	Button_short_press
000346 f489                      	jmp		clear_button_counter
000347 3090                      
000348 f0d1                      button_counter_more_than_512:	
                                 	call	Button_long_press
000349 3091                      
00034a f429                      clear_button_counter:
00034b 7b9f                      	clr		XL
00034c 940e 03e0                 	clr		XH
00034e 940c 0355                 	ldi		YL,LOW(BUTTON_COUNT)				
                                 	ldi		YH,HIGH(BUTTON_COUNT)
                                 	st		Y+,XL
000350 3093                      	st		Y,XH
000351 f489                      
000352 6490                      check_encoder_state:									;  ,       000353 940e 03e0                  
                                 	cpi		temph,3										;                                              
                                 	brne	enc_A_B_not_3								;     enc_state = 1  3     000355 2799                      
000356 940c 0363                 	cpi		enc_state,0
                                 	breq	exit_enc_proc
                                 
000358 3011                      	cpi		enc_state,1
000359 f419                      	brne	check_enc_state_3
00035a e093                      	cbr		enc_state,(1<<EMPF)
00035b 940c 0363                 	call	Change_parameter
                                 	jmp		clear_logical_encoder_state
                                 
00035d 3012                      check_enc_state_3:
00035e f419                      	cpi		enc_state,3
00035f e091                      	brne	exit_enc_proc
000360 940c 0363                 	sbr		enc_state,(1<<EMPF)
                                 	call	Change_parameter
                                 
000362 e092                      
                                 clear_logical_encoder_state:
                                 	clr		enc_state		
000363 9508                      	jmp		exit_enc_proc							
                                 
                                 enc_A_B_not_3:											;                                             
                                 	cpi		temph,1
                                 	brne	enc_A_B_not_1
                                 	ldi		enc_state,3
                                 	jmp		exit_enc_proc
                                 
000364 930f                      enc_A_B_not_1:
000365 2700                      	cpi		temph,2
000366 ebab                      	brne	enc_A_B_not_2
000367 e0b0                      	ldi		enc_state,1
000368 930c                      	jmp		exit_enc_proc
000369 910f                      
                                 enc_A_B_not_2:	
00036a fd40                      	ldi		enc_state,2
00036b 940c 0389                 
00036d ff41                      exit_enc_proc:
00036e 940c 03b1                 ret
000370 e023                      
000371 16e2                      
000372 f418                      /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
000373 94e3                      //////////	2
000374 940c 03b1                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
000376 e025                      Button_short_press:
000377 16e2                      	//             000378 f421                       SET_MODE_COUNTER
000379 e024                      	push	templ
00037a 2ee2                      	clr		templ
00037b 940c 03b1                 	ldi		XL,LOW(SET_MODE_COUNTER)				
                                 	ldi		XH,HIGH(SET_MODE_COUNTER)
00037d e024                      	st		X,templ
00037e 16e2                      	pop		templ
00037f f021                      ///////////////////////////////////////////////////////////////////////////
000380 e025                      	sbrc	state_flag,WWVM
000381 2ee2                      	jmp		bsp_timer_mode
000382 940c 03b1                 	sbrs	state_flag,WWSM
                                 	jmp		exit_bsp_proc							;          000384 24ee                      
000385 7f4d                      	ldi		temp_2,3
000386 9ac0                      	cp		set_segm,temp_2
000387 940c 03b1                 	brsh	bsp_clock_segment_4_5_0					;      ,   4  5
                                 	inc		set_segm
                                 	jmp		exit_bsp_proc
                                 bsp_clock_segment_4_5_0:
000389 ff41                      	ldi		temp_2,5
00038a 940c 039c                 	cp		set_segm,temp_2
00038c 94e3                      	brne	bsp_clock_segment_4_0
00038d e026                      	ldi		temp_2,4
00038e 16e2                      	mov		set_segm,temp_2
00038f f430                      	jmp		exit_bsp_proc
000390 e023                      bsp_clock_segment_4_0:
000391 16e2                      	ldi		temp_2,4
000392 f4f1                      	cp		set_segm,temp_2
000393 94e3                      	breq	bsp_clock_segment_4
000394 940c 03b1                 	ldi		temp_2,5
                                 	mov		set_segm,temp_2
                                 	jmp		exit_bsp_proc
000396 24ee                      bsp_clock_segment_4:
000397 7f4d                      	clr		set_segm
000398 940e 0706                 	cbr		state_flag,(1<<WWSM)
00039a 940c 03b1                 	sbi		PORTB,0												; 12 
                                 	jmp		exit_bsp_proc
                                 
00039c fd45                      //////////////////////////////////////////////////////////////////////////
00039d 940c 03aa                 bsp_timer_mode:
00039f 6240                      	sbrs	state_flag,WWSM
0003a0 ff47                      	jmp		bsp_timer_mode_check_bt_on				;         0003a1 940e 027c                  
0003a3 734f                      	inc		set_segm
0003a4 2400                      	ldi		temp_2,6
0003a5 2411                      	cp		set_segm,temp_2
0003a6 2422                      	brsh	bsp_timer_mode_clear_segm
0003a7 9423                      	ldi		temp_2,3
0003a8 940c 03b1                 	cp		set_segm,temp_2
                                 	brne	exit_bsp_proc
                                 	inc		set_segm
0003aa ff47                      	jmp		exit_bsp_proc
0003ab 940c 03b0                 
0003ad 774f                      bsp_timer_mode_clear_segm:
0003ae 940c 03b1                 	clr		set_segm
                                 	cbr		state_flag,(1<<WWSM)
                                 	call	Write_timer_parameters_to_eeprom		;    eeprom
0003b0 6840                      	jmp		exit_bsp_proc
                                 
                                 bsp_timer_mode_check_bt_on:
0003b1 9508                      	sbrc	state_flag,BTON
                                 	jmp		bsp_chek_pause_on
                                 	sbr		state_flag,(1<<BTON)								; 	
                                 	sbrs	state_flag,BTPS
                                 	call	Sound_1000Hz_ON
                                 	cbr		state_flag,(1<<BTRT) | (1<<BTPS)
                                 	clr		seconds
                                 	clr		minutes
                                 	clr		round
0003b2 930f                      	inc		round
0003b3 2700                      	jmp		exit_bsp_proc
0003b4 ebab                      
0003b5 e0b0                      bsp_chek_pause_on:
0003b6 930c                      	sbrs	state_flag,BTPS										;      
0003b7 910f                      	jmp		bsp_pause_is_off
                                 	cbr		state_flag,(1<<BTPS)
0003b8 fd40                      	jmp		exit_bsp_proc
0003b9 940c 03ca                 
0003bb fd41                      bsp_pause_is_off:
0003bc 940c 03c3                 	sbr		state_flag,(1<<BTPS)
0003be 6042                      
0003bf 24ee                      exit_bsp_proc:
0003c0 98c0                      ret
0003c1 940c 03df                 
                                 
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
0003c3 e70e                      //////////	3
0003c4 bd05                      /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
0003c5 6041                      
0003c6 714d                      Button_long_press:
0003c7 9ac0                      	//             0003c8 940c 03df                  SET_MODE_COUNTER
                                 	push	templ
                                 	clr		templ
0003ca ff41                      	ldi		XL,LOW(SET_MODE_COUNTER)				
0003cb 940c 03d2                 	ldi		XH,HIGH(SET_MODE_COUNTER)
0003cd e70e                      	st		X,templ
0003ce bd05                      	pop		templ
0003cf 714c                      /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
0003d0 940c 03df                 	sbrc	state_flag,WWVM
                                 	jmp		blp_timer_mode
                                 	sbrc	state_flag,WWSM
0003d2 fd45                      	jmp		blp_clock_mode_set
0003d3 940c 03da                 	sbr		state_flag,(1<<WWSM)				;    
0003d5 6042                      	clr		set_segm							
0003d6 714f                      	cbi		PORTB,0								; 12 
0003d7 24ee                      	jmp		exit_blp_proc
0003d8 940c 03df                 	
                                 blp_clock_mode_set:								;    +  12 
                                 	ldi		templ,(1<<COM21) | (1<<COM20) | (1<<WGM21) | (1<<WGM20) | PRESCALER_2_BT							;    2
0003da 714d                      	out		TCCR2,templ	
0003db 2400                      	sbr		state_flag,(1<<WWVM)
0003dc 2411                      	cbr		state_flag,(1<<WWSM) | (1<<BTON) | (1<<BTRT) | (1<<BTPS) 
0003dd 2422                      	sbi		PORTB,0
0003de 9423                      	jmp		exit_blp_proc
                                 
                                 blp_timer_mode:
0003df 9508                      	sbrs	state_flag,WWSM
                                 	jmp		blp_timer_not_set_mode	
                                 	ldi		templ,(1<<COM21) | (1<<COM20) | (1<<WGM21) | (1<<WGM20) | PRESCALER_2_CLK							;    2
                                 	out		TCCR2,templ			
                                 	cbr		state_flag,(1<<WWVM) | (1<<WWSM) | (1<<BTON) | (1<<BTRT) | (1<<BTPS) 								;     
                                 	jmp		exit_blp_proc
                                 
                                 blp_timer_not_set_mode:
                                 	sbrc	state_flag,BTON
0003e0 930f                      	jmp		blp_timer_is_on
0003e1 2700                      	sbr		state_flag,(1<<WWSM)											;     
0003e2 ebab                      	cbr		state_flag,(1<<BTON) | (1<<BTRT) | (1<<BTPS)
0003e3 e0b0                      	clr		set_segm
0003e4 930c                      	jmp		exit_blp_proc
0003e5 910f                      
                                 blp_timer_is_on:
0003e6 fd40                      	cbr		state_flag,(1<<WWSM) | (1<<BTON) | (1<<BTRT) | (1<<BTPS)		;    
0003e7 940c 04d0                 	clr		seconds
0003e9 ff41                      	clr		minutes
0003ea 940c 054f                 	clr		round
                                 	inc		round
0003ec 2700                      
0003ed e7a0                      exit_blp_proc:
0003ee e0b0                      ret
0003ef 0dae                      
0003f0 1fb0                      
0003f1 911c                      /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////	4
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
0003f2 16e0                      Change_parameter:
0003f3 f431                      	//             0003f4 2711                       SET_MODE_COUNTER
0003f5 24ff                      	push	templ
0003f6 940e 0288                 	clr		templ
0003f8 940c 054f                 	ldi		XL,LOW(SET_MODE_COUNTER)				
                                 	ldi		XH,HIGH(SET_MODE_COUNTER)
                                 	st		X,templ
                                 	pop		templ
0003fa e001                      /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
0003fb 16e0                      	sbrc	state_flag,WWVM		
0003fc f4c9                      	jmp		cp_timer_mode
0003fd 940e 0299                 	sbrs	state_flag,WWSM
0003ff fd96                      	jmp		exit_cp_proc
000400 940c 040a                 
000402 3010                      	clr		templ
000403 f419                      	ldi		XL,LOW(TWI_BUFFER_IN)
000404 e31b                      	ldi		XH,HIGH(TWI_BUFFER_IN)
000405 940c 040e                 	add		XL,set_segm
                                 	adc		XH,templ
                                 	ld		temph,X
000407 951a                      
000408 940c 040e                 ////////////////////////////////////////////////////////////////////
                                 ////////////////////////////////////////////////////////////////////     
                                 	cp		set_segm,templ							
00040a 9513                      	brne	cp_clock_mode_segm_1
00040b 331c                      	clr		temph												; 		
00040c f008                      	clr		byte_address
00040d 2711                      	call	Write_byte_to_DS1307
                                 	jmp		exit_cp_proc
                                 
00040e 940e 02a4                 ////////////////////////////////////////////////////////////////////
000410 e001                      cp_clock_mode_segm_1:
000411 2ef0                      	ldi		templ,1												
000412 940e 0288                 	cp		set_segm,templ										; 
000414 940c 054f                 	brne	cp_clock_mode_segm_2
                                 	call	BCD_TO_HEX
                                 	sbrc	enc_state,EMPF
                                 	jmp		blp_segm_1_enc_plus
000416 e002                      	cpi		temph,0
000417 16e0                      	brne	blp_segm_1_dec_min
000418 f4c9                      	ldi		temph,59
000419 940e 0299                 	jmp		blp_segm_1_write_byte
00041b fd96                      
00041c 940c 0426                 blp_segm_1_dec_min:
00041e 3010                      	dec		temph
00041f f419                      	jmp		blp_segm_1_write_byte
000420 e117                      
000421 940c 042a                 blp_segm_1_enc_plus:
                                 	inc		temph
                                 	cpi		temph,60
000423 951a                      	brlo	blp_segm_1_write_byte
000424 940c 042a                 	clr		temph	
                                 
                                 blp_segm_1_write_byte:
000426 9513                      	call	HEX_TO_BCD
000427 3118                      	ldi		templ,1
000428 f008                      	mov		byte_address,templ
000429 2711                      	call	Write_byte_to_DS1307
                                 	jmp		exit_cp_proc
                                 
00042a 940e 02a4                 ////////////////////////////////////////////////////////////////////
00042c e002                      cp_clock_mode_segm_2:
00042d 2ef0                      	ldi		templ,2											
00042e 940e 0288                 	cp		set_segm,templ	
000430 940c 054f                 	brne	cp_clock_mode_segm_3
                                 	call	BCD_TO_HEX												; 
                                 	sbrc	enc_state,EMPF
                                 	jmp		blp_segm_2_enc_plus
000432 e003                      	cpi		temph,0
000433 16e0                      	brne	blp_segm_2_dec_hour
000434 f4a9                      	ldi		temph,23
000435 fd96                      	jmp		blp_segm_2_write_byte
000436 940c 0440                 	
000438 3011                      blp_segm_2_dec_hour:
000439 f419                      	dec		temph
00043a e017                      	jmp		blp_segm_2_write_byte
00043b 940c 0444                 
                                 blp_segm_2_enc_plus:
                                 	inc		temph
00043d 951a                      	cpi		temph,24
00043e 940c 0444                 	brlo	blp_segm_2_write_byte
                                 	clr		temph
                                 
000440 9513                      blp_segm_2_write_byte:
000441 3018                      	call	HEX_TO_BCD
000442 f008                      	ldi		templ,2
000443 e011                      	mov		byte_address,templ
                                 	call	Write_byte_to_DS1307
                                 	jmp		exit_cp_proc
000444 e003                      	
000445 2ef0                      ////////////////////////////////////////////////////////////////////
000446 940e 0288                 cp_clock_mode_segm_3:
000448 940c 054f                 	ldi		templ,3										
                                 	cp		set_segm,templ	
                                 	brne	cp_clock_mode_segm_5											;  
                                 	sbrc	enc_state,EMPF
00044a e004                      	jmp		blp_segm_3_enc_plus
00044b 16e0                      	cpi		temph,1
00044c f011                      	brne	blp_segm_3_dec_day
00044d 940c 04ae                 	ldi		temph,7
                                 	jmp		blp_segm_3_write_byte
00044f e7a0                      
000450 e0b0                      blp_segm_3_dec_day:
000451 9614                      	dec		temph
000452 911d                      	jmp		blp_segm_3_write_byte
000453 912d                      
000454 913c                      blp_segm_3_enc_plus:	
000455 940e 0299                 	inc		temph
                                 	cpi		temph,8
                                 	brlo	blp_segm_3_write_byte
000457 3021                      	ldi		temph,1
000458 f061                      
000459 3023                      blp_segm_3_write_byte:
00045a f051                      	ldi		templ,3
00045b 3025                      	mov		byte_address,templ
00045c f041                      	call	Write_byte_to_DS1307
00045d 3027                      	jmp		exit_cp_proc	
00045e f031                      
00045f 3028                      ////////////////////////////////////////////////////////////////////
000460 f021                      cp_clock_mode_segm_5:
000461 3120                      	ldi		templ,4									
000462 f011                      	cp		set_segm,templ	
000463 3122                      	breq	cp_clock_mode_segm_5_intermed
000464 f089                      	jmp		cp_clock_mode_segm_4
                                 cp_clock_mode_segm_5_intermed:													; 	
                                 	ldi		XL,LOW(TWI_BUFFER_IN)
                                 	ldi		XH,HIGH(TWI_BUFFER_IN)
000465 fd96                      	adiw	XL,4
000466 940c 0470                 	ld		temph,X+
000468 3011                      	ld		temp_2,X+
000469 f419                      	ld		temp_3,X
00046a e11f                      	call	BCD_TO_HEX	
00046b 940c 04a6                 
                                 
                                 	cpi		temp_2,1
00046d 951a                      	breq	month_31
00046e 940c 04a6                 	cpi		temp_2,3
                                 	breq	month_31
                                 	cpi		temp_2,5
000470 9513                      	breq	month_31
000471 3210                      	cpi		temp_2,7
000472 f198                      	breq	month_31
000473 e011                      	cpi		temp_2,8
000474 940c 04a6                 	breq	month_31
                                 	cpi		temp_2,0x10
                                 	breq	month_31
                                 	cpi		temp_2,0x12
000476 3022                      	breq	month_2	
000477 f4f9                      
000478 fd96                      ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;   31 
000479 940c 0489                 month_31:
00047b 3011                      	sbrc	enc_state,EMPF
00047c f449                      	jmp		blp_segm_5_month_31_plus
00047d 7033                      	cpi		temph,1
00047e 3030                      	brne	blp_segm_5_month_31_dec
00047f f419                      	ldi		temph,31
000480 e11c                      	jmp		blp_segm_5_write_byte
000481 940c 04a6                 	
                                 blp_segm_5_month_31_dec:
                                 	dec		temph
000483 e11d                      	jmp		blp_segm_5_write_byte
000484 940c 04a6                 
                                 blp_segm_5_month_31_plus:
                                 	inc		temph
000486 951a                      	cpi		temph,32
000487 940c 04a6                 	brlo	blp_segm_5_write_byte
                                 	ldi		temph,1
                                 	jmp		blp_segm_5_write_byte
000489 9513                      
00048a 7033                      ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;     
00048b 3030                      month_2:
00048c f429                      	cpi		temp_2,2
00048d 311d                      	brne	month_30
00048e f0b8                      	sbrc	enc_state,EMPF
00048f e011                      	jmp		blp_segm_5_month_2_plus
000490 940c 04a6                 	cpi		temph,1
                                 	brne	blp_segm_5_month_2_dec
                                 	andi	temp_3,3
000492 311e                      	cpi		temp_3,0
000493 f090                      	brne	blp_segm_5_month_2_29
000494 e011                      	ldi		temph,28
000495 940c 04a6                 	jmp		blp_segm_5_write_byte
                                 
                                 blp_segm_5_month_2_29:
                                 	ldi		temph,29
000497 fd96                      	jmp		blp_segm_5_write_byte
000498 940c 04a2                 
00049a 3011                      blp_segm_5_month_2_dec:
00049b f419                      	dec		temph
00049c e11e                      	jmp		blp_segm_5_write_byte
00049d 940c 04a6                 
                                 blp_segm_5_month_2_plus:
                                 	inc		temph
00049f 951a                      	andi	temp_3,3
0004a0 940c 04a6                 	cpi		temp_3,0
                                 	brne	blp_segm_5_month_2_29_plus
                                 	cpi		temph,29
0004a2 9513                      	brlo	blp_segm_5_write_byte
0004a3 311f                      	ldi		temph,1
0004a4 f008                      	jmp		blp_segm_5_write_byte
0004a5 e011                      
                                 blp_segm_5_month_2_29_plus:
                                 	cpi		temph,30
0004a6 940e 02a4                 	brlo	blp_segm_5_write_byte
0004a8 e004                      	ldi		temph,1
0004a9 2ef0                      	jmp		blp_segm_5_write_byte
0004aa 940e 0288                 
0004ac 940c 054f                 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;   30 
                                 month_30:
                                 	sbrc	enc_state,EMPF
                                 	jmp		blp_segm_5_month_30_plus
0004ae e005                      	cpi		temph,1
0004af 16e0                      	brne	blp_segm_5_month_30_dec
0004b0 f011                      	ldi		temph,30
0004b1 940c 054f                 	jmp		blp_segm_5_write_byte
                                 
0004b3 e7a0                      blp_segm_5_month_30_dec:
0004b4 e0b0                      	dec		temph
0004b5 9615                      	jmp		blp_segm_5_write_byte
0004b6 911c                      
0004b7 940e 0299                 blp_segm_5_month_30_plus:
0004b9 fd96                      	inc		temph
0004ba 940c 04c4                 	cpi		temph,31
0004bc 3011                      	brlo	blp_segm_5_write_byte
0004bd f419                      	ldi		temph,1
0004be e01c                      
0004bf 940c 04c8                 blp_segm_5_write_byte:
                                 	call	HEX_TO_BCD
                                 	ldi		templ,4
0004c1 951a                      	mov		byte_address,templ
0004c2 940c 04c8                 	call	Write_byte_to_DS1307
                                 	jmp		exit_cp_proc
                                 
0004c4 9513                      ////////////////////////////////////////////////////////////////////
0004c5 301d                      cp_clock_mode_segm_4:
0004c6 f008                      	ldi		templ,5									
0004c7 e011                      	cp		set_segm,templ	
                                 	breq	cp_clock_mode_segm_4_intermed
                                 	jmp		exit_cp_proc	
0004c8 940e 02a4                 cp_clock_mode_segm_4_intermed:													; 	
0004ca e005                      	ldi		XL,LOW(TWI_BUFFER_IN)
0004cb 2ef0                      	ldi		XH,HIGH(TWI_BUFFER_IN)
0004cc 940e 0288                 	adiw	XL,5
0004ce 940c 054f                 	ld		temph,X
                                 	call	BCD_TO_HEX
                                 	sbrc	enc_state,EMPF
                                 	jmp		cp_clock_mode_segm_4_enc_plus
                                 	cpi		temph,1
0004d0 ff41                      	brne	cp_clock_mode_segm_4_dec
0004d1 940c 054f                 	ldi		temph,12
                                 	jmp		blp_segm_4_write_byte
                                 
0004d3 e000                      cp_clock_mode_segm_4_dec:
0004d4 16e0                      	dec		temph
0004d5 f4b9                      	jmp		blp_segm_4_write_byte
0004d6 fd96                      
0004d7 940c 04e3                 cp_clock_mode_segm_4_enc_plus:
0004d9 e00a                      	inc		temph
0004da 1630                      	cpi		temph,13
0004db f420                      	brlo	blp_segm_4_write_byte
0004dc e302                      	ldi		temph,1
0004dd 2e30                      
0004de 940c 054f                 blp_segm_4_write_byte:
                                 	call	HEX_TO_BCD
                                 	ldi		templ,5
0004e0 1a30                      	mov		byte_address,templ
0004e1 940c 054f                 	call	Write_byte_to_DS1307
                                 	jmp		exit_cp_proc	
                                 
0004e3 e00a                      ////////////////////////////////////////////////////////////////////
0004e4 0e30                      ////////////////////////////////////////////////////////////////////    
0004e5 e30c                      cp_timer_mode:
0004e6 1630                      	sbrs	state_flag,WWSM
0004e7 f410                      	jmp		exit_cp_proc
0004e8 940c 054f                 
                                 ////////////////////////////////////////////////////////////////////
                                 	ldi		templ,0
0004ea 2433                      	cp		set_segm,templ
0004eb 940c 054f                 	brne	cp_timer_mode_segm_1
                                 	sbrc	enc_state,EMPF											;   . 
                                 	jmp		cp_timer_mode_segm_0_plus
                                 	ldi		templ,10
0004ed e001                      	cp		sec_work,templ
0004ee 16e0                      	brsh	cp_timer_mode_segm_0_10
0004ef f4a9                      	ldi		templ,50
0004f0 fd96                      	mov		sec_work,templ
0004f1 940c 04fc                 	jmp		exit_cp_proc
0004f3 2044                      
0004f4 f421                      cp_timer_mode_segm_0_10:
0004f5 e603                      	sub		sec_work,templ
0004f6 2e40                      	jmp		exit_cp_proc
0004f7 940c 054f                 
                                 cp_timer_mode_segm_0_plus:
                                 	ldi		templ,10
0004f9 944a                      	add		sec_work,templ
0004fa 940c 054f                 	ldi		templ,60
                                 	cp		sec_work,templ
                                 	brsh	cp_timer_mode_segm_0_plus_60
0004fc 9443                      	jmp		exit_cp_proc
0004fd e604                      
0004fe 1640                      cp_timer_mode_segm_0_plus_60:
0004ff f410                      	clr		sec_work
000500 940c 054f                 	jmp		exit_cp_proc
                                 
                                 ////////////////////////////////////////////////////////////////////
000502 2444                      cp_timer_mode_segm_1:
000503 940c 054f                 	ldi		templ,1
                                 	cp		set_segm,templ
                                 	brne	cp_timer_mode_segm_2
                                 	sbrc	enc_state,EMPF											;   . 
000505 e002                      	jmp		cp_timer_mode_segm_1_plus
000506 16e0                      	tst		min_work
000507 f4b9                      	brne	cp_timer_mode_segm_1_not_zero
000508 fd96                      	ldi		templ,99
000509 940c 0515                 	mov		min_work,templ
00050b e001                      	jmp		exit_cp_proc
00050c 1650                      	
00050d f421                      cp_timer_mode_segm_1_not_zero:
00050e e603                      	dec		min_work
00050f 2e50                      	jmp		exit_cp_proc
000510 940c 054f                 
                                 cp_timer_mode_segm_1_plus:	
                                 	inc		min_work
000512 945a                      	ldi		templ,100
000513 940c 054f                 	cp		min_work,templ
                                 	brsh	cp_timer_mode_segm_1_plus_100
                                 	jmp		exit_cp_proc
000515 9453                      
000516 e604                      cp_timer_mode_segm_1_plus_100:
000517 1650                      	clr		min_work
000518 f410                      	jmp		exit_cp_proc
000519 940c 054f                 
                                 ////////////////////////////////////////////////////////////////////
                                 cp_timer_mode_segm_2:
00051b e001                      	ldi		templ,2
00051c 2e50                      	cp		set_segm,templ
00051d 940c 054f                 	brne	cp_timer_mode_segm_4
                                 	sbrc	enc_state,EMPF											;   . 
                                 	jmp		cp_timer_mode_segm_2_plus
                                 	ldi		templ,1
00051f e004                      	cp		round_work,templ
000520 16e0                      	brne	cp_timer_mode_segm_2_dec
000521 f4b9                      	ldi		templ,99
000522 fd96                      	mov		round_work,templ
000523 940c 052f                 	jmp		exit_cp_proc
000525 e00a                      
000526 1660                      cp_timer_mode_segm_2_dec:
000527 f420                      	dec		round_work
000528 e302                      	jmp		exit_cp_proc
000529 2e60                      
00052a 940c 054f                 cp_timer_mode_segm_2_plus:
                                 	inc		round_work
                                 	ldi		templ,100
00052c 1a60                      	cp		round_work,templ
00052d 940c 054f                 	brsh	cp_timer_mode_segm_2_plus_100
                                 	jmp		exit_cp_proc
                                 
00052f e00a                      cp_timer_mode_segm_2_plus_100:
000530 0e60                      	ldi		templ,1
000531 e30c                      	mov		round_work,templ
000532 1660                      	jmp		exit_cp_proc
000533 f410                      	
000534 940c 054f                 ////////////////////////////////////////////////////////////////////
                                 cp_timer_mode_segm_4:
                                 	ldi		templ,4
000536 2466                      	cp		set_segm,templ
000537 940c 054f                 	brne	cp_timer_mode_segm_5
                                 	sbrc	enc_state,EMPF											;   . 
                                 	jmp		cp_timer_mode_segm_4_plus
                                 	ldi		templ,10
000539 e005                      	cp		sec_rest,templ
00053a 16e0                      	brsh	cp_timer_mode_segm_4_10
00053b f499                      	ldi		templ,50
00053c fd96                      	mov		sec_rest,templ
00053d 940c 0548                 	jmp		exit_cp_proc
00053f 2077                      
000540 f421                      cp_timer_mode_segm_4_10:
000541 e603                      	sub		sec_rest,templ
000542 2e70                      	jmp		exit_cp_proc
000543 940c 054f                 
                                 cp_timer_mode_segm_4_plus:
                                 	ldi		templ,10
000545 947a                      	add		sec_rest,templ
000546 940c 054f                 	ldi		templ,60
                                 	cp		sec_rest,templ
                                 	brsh	cp_timer_mode_segm_4_plus_60
000548 9473                      	jmp		exit_cp_proc
000549 e604                      
00054a 1670                      cp_timer_mode_segm_4_plus_60:
00054b f410                      	clr		sec_rest
00054c 940c 054f                 	jmp		exit_cp_proc
                                 
                                 ////////////////////////////////////////////////////////////////////
00054e 2477                      cp_timer_mode_segm_5:
                                 	ldi		templ,5
                                 	cp		set_segm,templ
00054f 9508                      	brne	exit_cp_proc
                                 	sbrc	enc_state,EMPF											;   . 
                                 	jmp		cp_timer_mode_segm_5_plus
                                 	tst		min_rest
                                 	brne	cp_timer_mode_segm_5_not_zero
                                 	ldi		templ,99
0000b8                           	mov		min_rest,templ
                                 	jmp		exit_cp_proc
0000b9                           	
                                 cp_timer_mode_segm_5_not_zero:
0000bb                           	dec		min_rest
                                 	jmp		exit_cp_proc
                                 
                                 .include	"Timers.asm"
                                 
                                         .
                                 1.  1 -   10 .
                                 2.  1.
                                 3.  2.      t_count.         
                                 RPTF (     ),T2IF (   )  WWFF (    ).
                                 4.         sdi_high_time, sdi_low_time,
                                 sdi_high_data  sdi_low_data.      :
                                 - sdi_low_time = digit_number*2,
                                 - sdi_high_time = digit_number*2+1,
                                 - sdi_low_data = digit_number*2+12,
                                 - sdi_high_data = digit_number*2+13.
                                  ,        0,             
                                     . 
                                 5.   1.      / MBI5026,        .
                                       LE  OE      PORTA    .
                                 */
                                 
                                 
                                 ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////////////////////////////////								1
                                 ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                  Timer1_ON:
000550 e009                      	ldi		templ,(1<<CS10) | (1<<WGM12)
000551 bd0e                      	out		TCCR1B,templ
000552 e90f                      	ldi		templ,LOW(OCR1_REG)
000553 e010                      	ldi		temph,HIGH(OCR1_REG)	
000554 bd0a                      	out		OCR1AL,templ
000555 bd1b                      	out		OCR1AH,temph
000556 b709                      	in		templ,TIMSK
000557 6100                      	sbr		templ,(1<<OCIE1A)
000558 bf09                      	out		TIMSK,templ
000559 24cc                      	clr		mbi_clk_counter
00055a 9508                       ret
                                 
                                 ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////////////////////////////////								2
                                 ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                  Timer1_OFF:
00055b 2700                      	clr		templ
00055c bd0e                      	out		TCCR1B,templ	
00055d 9508                       ret
                                 
                                 ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////////////////////////////////								3
                                 ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 //  2
                                 Timer2:
                                 //   	
00055e 930f                      	push	templ
00055f 931f                      	push	temph
000560 b70f                      	in		templ,SREG
000561 930f                      	push	templ												//7
                                 	
                                 //   	
000562 9583                      	inc		t_count												//8
                                 
                                 //    	
000563 3880                      	cpi		t_count,0x80
000564 f018                      	brlo	set_flicking_flag
000565 7f4b                      	cbr		state_flag,(1<<WWFF)
000566 940c 0569                 	jmp		timer2_ww_mode
                                 set_flicking_flag:
000568 6044                      	sbr		state_flag,(1<<WWFF)
                                 
                                 //  
                                 timer2_ww_mode:	
000569 ff40                      	sbrs	state_flag,WWVM
00056a 940c 0575                 	jmp		timer2_clock_mode
00056c fd41                      	sbrc	state_flag,WWSM
00056d 940c 0575                 	jmp		timer2_clock_mode
                                 // 	
00056f 3f84                      	cpi		t_count,F_TIMER2_BT
000570 f048                      	brlo	read_encoder_state
000571 2788                      	clr		t_count
000572 6140                      	sbr		state_flag,(1<<RPTF)	
000573 940c 057a                 	jmp		read_encoder_state
                                 
                                 // 
                                 timer2_clock_mode:
000575 2f08                      	mov		templ,t_count
000576 730e                      	andi	templ,0x3E
000577 330e                      	cpi		templ,0x3E
000578 f409                      	brne	read_encoder_state
000579 6140                      	sbr		state_flag,(1<<RPTF)	
                                 
                                 //  
                                 read_encoder_state:
00057a b300                      	in		templ,PIND											;  ,    
00057b 710c                      	andi	templ,0x1C
00057c 6800                      	sbr		templ,(1<<T2IF)
00057d 7093                      	andi	enc_state,3
00057e 2b90                      	or		enc_state,templ
                                 	
                                 
                                 //   
                                 change_digit_number:	
                                 	//call	Get_Next_Digit
                                 
                                 exit_timer2:
                                 // 		
00057f 910f                      	pop		templ
000580 bf0f                      	out		SREG,templ
000581 911f                      	pop		temph
000582 910f                      	pop		templ
000583 9518                      reti
                                 
                                 
                                 ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////////////////////////////////								4
                                 ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                  Get_Next_Digit:
000584 e006                      	ldi		templ,6
000585 94d3                      	inc		digit_count
000586 16d0                      	cp		digit_count,templ
000587 f008                      	brlo	digit_lower_six
000588 24dd                      	clr		digit_count
                                 digit_lower_six:
                                 //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
000589 2d1d                      	mov		temph,digit_count							;       
00058a 0f11                      	lsl		temph										;  2
00058b 2700                      	clr		templ
00058c e9c8                      	ldi		YL,LOW(OUTPUT_BUFFER)
00058d e0d0                      	ldi		YH,HIGH(OUTPUT_BUFFER)
00058e 0fc1                      	add		YL,temph
00058f 1fd0                      	adc		YH,templ
000590 9099                      	ld		sdi_low_time,Y+
000591 8088                      	ld		sdi_high_time,Y
000592 5f14                      	subi	temph,-12
000593 2700                      	clr		templ
000594 e9c8                      	ldi		YL,LOW(OUTPUT_BUFFER)
000595 e0d0                      	ldi		YH,HIGH(OUTPUT_BUFFER)
000596 0fc1                      	add		YL,temph
000597 1fd0                      	adc		YH,templ
000598 90b9                      	ld		sdi_low_data,Y+
000599 80a8                      	ld		sdi_high_data,Y
                                 //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
00059a bb05                      	out		PORT_ANODE,templ							;   
00059b 9ad9                      	sbi		PORT_CATHODE,OE
00059c 24cc                      	clr		mbi_clk_counter
                                 
                                 	
                                 /*	ldi		templ,0xAA
                                 	call	Send_UART*/
                                 /*	mov		templ,round_work
                                 	call	Send_UART*/
                                 /*	mov		templ,sdi_low_time
                                 	call	Send_UART
                                 	mov		templ,sdi_high_time
                                 	call	Send_UART
                                 	mov		templ,sdi_low_data
                                 	call	Send_UART
                                 	mov		templ,sdi_high_data
                                 	call	Send_UART*/
                                 
00059d 940e 0550                 	call	Timer1_ON									;  1 (  / MBI5026)
                                 
00059f 9508                      ret
                                 
                                 ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////////////////////////////////								5
                                 ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                  Timer1:
0005a0 93ef                      	push	ZL
0005a1 93ff                      	push	ZH	
0005a2 930f                      	push	templ
0005a3 931f                      	push	temph
0005a4 b70f                      	in		templ,SREG
0005a5 930f                      	push	templ	
                                 		
0005a6 fcc5                      	sbrc	mbi_clk_counter,5
0005a7 c012                      	rjmp	data_latch_end								//   32
0005a8 fcc0                      	sbrc	mbi_clk_counter,0				
0005a9 c00e                      	rjmp	set_clk_line								//  
                                  /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
0005aa fe87                      	sbrs	sdi_high_time,7								//  sdi        sdi_high
0005ab 98da                      	cbi		PORT_CATHODE,SDI_TIME
0005ac fc87                      	sbrc	sdi_high_time,7
0005ad 9ada                      	sbi		PORT_CATHODE,SDI_TIME
0005ae fea7                      	sbrs	sdi_high_data,7							
0005af 98dd                      	cbi		PORT_CATHODE,SDI_DATA
0005b0 fca7                      	sbrc	sdi_high_data,7
0005b1 9add                      	sbi		PORT_CATHODE,SDI_DATA
                                  
0005b2 1c99                       	rol		sdi_low_time								//  1    sdi
0005b3 1c88                      	rol		sdi_high_time 
0005b4 1cbb                      	rol		sdi_low_data
0005b5 1caa                      	rol		sdi_high_data 
                                 
0005b6 98db                      	cbi		PORT_CATHODE,CLK						//  0  clk  
0005b7 c01a                      	rjmp	exit_timer1
                                  set_clk_line:
0005b8 9adb                      	sbi		PORT_CATHODE,CLK						//  1  clk  
0005b9 c018                      	rjmp	exit_timer1	
                                  /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                  //  ,         LE  1
                                  //   OE  0
                                  data_latch_end:
0005ba fcc1                       	sbrc	mbi_clk_counter,1							//   32(bit0=0, bit1=0) -  0  clk,  33(bit0=1, bit1=0)  LE 1				
0005bb c008                      	rjmp	line_le_oe
0005bc fcc0                      	sbrc	mbi_clk_counter,0	
0005bd c004                      	rjmp	set_le_line
0005be 98db                      	cbi		PORT_CATHODE,CLK
0005bf 98da                      	cbi		PORT_CATHODE,SDI_TIME
0005c0 98dd                      	cbi		PORT_CATHODE,SDI_DATA
0005c1 c010                      	rjmp	exit_timer1
                                  set_le_line:
0005c2 9adc                      	sbi		PORT_CATHODE,LE
0005c3 c00e                      	rjmp	exit_timer1
                                  //   34(bit0=0, bit1=1) -  0  LE,  35(bit0=1, bit1=1)  0  OE
                                  line_le_oe:
0005c4 fcc0                      	sbrc	mbi_clk_counter,0	
0005c5 c002                      	rjmp	clr_oe_line
0005c6 98dc                      	cbi		PORT_CATHODE,LE
0005c7 c00a                      	rjmp	exit_timer1
                                  clr_oe_line:
0005c8 98d9                      	cbi		PORT_CATHODE,OE
0005c9 2700                      	clr		templ
0005ca ebe8                      	ldi		ZL,LOW(2*ANODE_OUTPUT)						;     
0005cb e0fb                      	ldi		ZH,HIGH(2*ANODE_OUTPUT)
0005cc 0ded                      	add		ZL,digit_count
0005cd 1ff0                      	adc		ZH,templ
0005ce 9104                      	lpm		templ,Z
0005cf bb05                      	out		PORT_ANODE,templ
0005d0 940e 055b                 	call	Timer1_OFF
                                 
                                  //,   
                                  exit_timer1:
0005d2 94c3                      	inc		mbi_clk_counter	
0005d3 910f                      	pop		templ
0005d4 bf0f                      	out		SREG,templ
0005d5 911f                      	pop		temph
0005d6 910f                      	pop		templ
0005d7 91ff                      	pop		ZH
0005d8 91ef                      	pop		ZL
0005d9 9518                       reti
                                 
                                 ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////////////////////////////////						6		
                                 ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 Timer2_ON:
                                 /*	ldi		templ,(1<<COM21) | (1<<WGM21) | (1<<WGM20) | PRESCALER_0
                                 	out		TCCR2,templ
                                 	ldi		templ,120
                                 	out		OCR2,templ
                                 	ldi		templ,(1<<TOIE2)
                                 	out		TIMSK,templ*/
0005da 9508                      ret
                                 
                                 ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////////////////////////////////						7		
                                 ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 Timer2_OFF:
                                 /*	clr		templ
                                 	out		TCCR2,templ*/
0005db 9508                      ret
                                 
                                 
                                 
                                  ANODE_OUTPUT:
0005dc 0804
0005dd 2010
0005de 8040                      	.db		0x04,	0x08,	0x10,	0x20,	0x40,	0x80
                                 
                                 .include	"UARTFunctions.asm"
                                 
                                        UART
                                 1.     ,      templ.
                                 2.        .
                                 3.       .     ""  ,      .
                                             +   .
                                 4.     .  -       9 ( ""  ""    9),
                                      .     ,    , 
                                    (    = 0xCC).    ,   7     .
                                      ,      ,     
                                 UART_TEMP          TWI_BUFFER_OUT.
                                 5.      UART_TEMP         TWI_BUFFER_OUT.    TWI_BUFFER_OUT -   + 
                                 /,  -     ,  -   ( 7).
                                 */
                                 
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////	1
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 Send_UART:
0005df 9b5d                      	sbis	UCSRA,UDRE
0005e0 cffe                      	rjmp	Send_UART
0005e1 b90c                      	out		UDR,templ
0005e2 9508                      ret
                                 
                                 
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////	2
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 UART_TX:
0005e3 930f                      	push	templ
0005e4 931f                      	push	temph
0005e5 b70f                      	in		templ,SREG
0005e6 930f                      	push	templ
                                 
0005e7 3077                      	cpi		count,7
0005e8 f448                      	brsh	exit_uart_tx
0005e9 2711                      	clr		temph
0005ea e7a0                      	ldi		XL,LOW(TWI_BUFFER_IN)
0005eb e0b0                      	ldi		XH,HIGH(TWI_BUFFER_IN)
0005ec 0fa7                      	add		XL,count
0005ed 1fb1                      	adc		XH,temph
0005ee 910c                      	ld		templ,X
0005ef 940e 05df                 	call	Send_UART	
                                 
0005f1 9573                      	inc		count
                                 
                                 exit_uart_tx:	
0005f2 910f                      	pop		templ
0005f3 bf0f                      	out		SREG,templ
0005f4 911f                      	pop		temph
0005f5 910f                      	pop		templ
0005f6 9518                      reti
                                 
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////	3
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 UART_RX:
0005f7 932f                      	push	temp_2
0005f8 930f                      	push	templ
0005f9 931f                      	push	temph
0005fa 93af                      	push	XL
0005fb 93bf                      	push	XH
0005fc 93cf                      	push	YL
0005fd 93df                      	push	YH
0005fe b70f                      	in		templ,SREG
0005ff 930f                      	push	templ
                                 
000600 b10c                      	in		templ,UDR
000601 940e 05df                 	call	Send_UART
000603 2722                      	clr		temp_2
000604 ebac                      	ldi		XL,LOW(RX_HEAD)
000605 e0b0                      	ldi		XH,HIGH(RX_HEAD)
000606 911c                      	ld		temph,X
                                 		
000607 ebce                      	ldi		YL,LOW(UART_IN)
000608 e0d0                      	ldi		YH,HIGH(UART_IN)
000609 0fc1                      	add		YL,temph
00060a 1fd2                      	adc		YH,temp_2
00060b 8308                      	st		Y,templ
                                 
00060c 9513                      	inc		temph
00060d 731f                      	andi	temph,0x3F
00060e 931c                      	st		X,temph
                                 
00060f 910f                      	pop		templ
000610 bf0f                      	out		SREG,templ
000611 91df                      	pop		YH
000612 91cf                      	pop		YL
000613 91bf                      	pop		XH
000614 91af                      	pop		XL
000615 911f                      	pop		temph
000616 910f                      	pop		templ
000617 912f                      	pop		temp_2
000618 9518                      reti
                                 
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////	4
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 UART_proc:
000619 ebac                      	ldi		XL,LOW(RX_HEAD)							; 
00061a e0b0                      	ldi		XH,HIGH(RX_HEAD)
00061b 911c                      	ld		temph,X
                                 
00061c ebcd                      	ldi		YL,LOW(RX_TAIL)							; 
00061d e0d0                      	ldi		YH,HIGH(RX_TAIL)
00061e 8108                      	ld		templ,Y
                                 
00061f 2f20                      	mov		temp_2,templ
000620 2f31                      	mov		temp_3,temph
                                 
000621 1b32                      	sub		temp_3,temp_2							;      
000622 733f                      	andi	temp_3,0x3F									
                                 
000623 3039                      	cpi		temp_3,9								;        9   ( )
000624 f410                      	brsh	uart_packet_income
000625 940c 064e                 	jmp		exit_uart_proc
                                 
                                 uart_packet_income:
000627 2733                      	clr		temp_3									;  
000628 ebae                      	ldi		XL,LOW(UART_IN)							
000629 e0b0                      	ldi		XH,HIGH(UART_IN)
00062a 0fa0                      	add		XL,templ
00062b 1fb3                      	adc		XH,temp_3
00062c 912d                      	ld		temp_2,X+
                                 
00062d 3c2c                      	cpi		temp_2,0xCC								;,     
00062e f029                      	breq	packet_start_byte
00062f 9503                      	inc		templ									; ,   
000630 730f                      	andi	templ,0x3F
000631 8308                      	st		Y,templ
000632 940c 0619                 	jmp		UART_proc
                                 
                                 packet_start_byte:									;   ,   8   
000634 efce                      	ldi		YL,LOW(UART_TEMP)							
000635 e0d0                      	ldi		YH,HIGH(UART_TEMP)						;       ,    
000636 2711                      	clr		temph									;        (  TWI_BUFFER_OUT)
                                 
                                 next_uart_byte:
000637 913d                      	ld		temp_3,X+
000638 9339                      	st		Y+,temp_3
000639 0f23                      	add		temp_2,temp_3
00063a 9513                      	inc		temph
00063b 3017                      	cpi		temph,7
00063c f3d0                      	brlo	next_uart_byte
                                 
00063d 913c                      	ld		temp_3,X
00063e 1723                      	cp		temp_2,temp_3
00063f f039                      	breq	crc_is_good
000640 9503                      	inc		templ
000641 730f                      	andi	templ,0x3F
000642 ebcd                      	ldi		YL,LOW(RX_TAIL)							; 
000643 e0d0                      	ldi		YH,HIGH(RX_TAIL)
000644 8308                      	st		Y,templ
                                 
000645 940c 0619                 	jmp		UART_proc
                                 
                                 crc_is_good:
000647 5f07                      	subi	templ,-9
000648 730f                      	andi	templ,0x3F
000649 ebcd                      	ldi		YL,LOW(RX_TAIL)							;   ,     9    
00064a e0d0                      	ldi		YH,HIGH(RX_TAIL)
00064b 8308                      	st		Y,templ									
                                 	
00064c 940e 064f                 	call	Write_packet_to_TWI_buffer				;        
                                 	
                                 exit_uart_proc:
00064e 9508                      ret
                                 
                                 
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////	5
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 Write_packet_to_TWI_buffer:
00064f 2711                      	clr		temph
000650 e6a0                      	ldi		XL,LOW(TWI_BUFFER_OUT)										; ,        
000651 e0b0                      	ldi		XH,HIGH(TWI_BUFFER_OUT)
000652 efce                      	ldi		YL,LOW(UART_TEMP)											;  
000653 e0d0                      	ldi		YH,HIGH(UART_TEMP)
000654 ed00                      	ldi		templ,(DS1307_ADDRESS<<1)|write								;  -  / +  
000655 930d                      	st		X+,templ													;  -     
000656 2700                      	clr		templ														;  -      
000657 930d                      	st		X+,templ
                                 write_next_byte_to_twi_buffer:
000658 9109                      	ld		templ,Y+
000659 930d                      	st		X+,templ
00065a 9513                      	inc		temph
00065b 3017                      	cpi		temph,7
00065c f7d9                      	brne	write_next_byte_to_twi_buffer	
00065d e069                      	ldi		twi_packet_size,9
00065e 2700                      	clr		templ
00065f 2ef0                      	mov		byte_address,templ
000660 940e 0065                 	call	Start
000662 940e 00d6                 	call	Wait_TWI_finish	
                                 
000664 9508                      ret	
                                 
                                 .dseg	
                                 
0000bc                           RX_HEAD:		.byte	1
                                 
0000bd                           RX_TAIL:		.byte	1
                                 
0000be                           UART_IN:		.byte	64
                                 
0000fe                           UART_TEMP:		.byte	7
                                 
                                 .cseg
                                 .include	"ADC.asm"
                                 
                                      ,   ,
                                    .
                                 1. ,  ,      .  
                                  OCR  1.
                                 */
                                 
                                 ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////////////////////////////////								1
                                 ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 Set_brightness:
                                  // 
000665 9a36                      	sbi		ADCSRA,ADSC
                                  wait_conv:
000666 9936                      	sbic	ADCSRA,ADSC
000667 940c 0666                 	jmp		wait_conv
000669 b104                      	in		templ,ADCL
00066a b115                      	in		temph,ADCH
                                 
                                 /*	ldi		templ,0xFF
                                 	sub		templ,temph*/
00066b 3f1f                      	cpi		temph,0xFF
00066c f409                      	brne	not_abs_dark
00066d ef1e                      	ldi		temph,0xFE
                                 not_abs_dark:
00066e 940e 0671                 	call	Average_measure
000670 9508                      ret
                                 
                                 
                                 Average_measure:
000671 e0a5                      	ldi		XL,LOW(ADC_NUM)							;       
000672 e0b1                      	ldi		XH,HIGH(ADC_NUM)
000673 910c                      	ld		templ,X
                                 	
000674 2722                      	clr		temp_2
000675 e0c6                      	ldi		YL,LOW(ADC_RES)							;    
000676 e0d1                      	ldi		YH,HIGH(ADC_RES)
000677 0fc0                      	add		YL,templ
000678 1fd2                      	adc		YH,temp_2
000679 8318                      	st		Y,temph
                                 
00067a 9503                      	inc		templ									;     32        
00067b 3200                      	cpi		templ,32
00067c f018                      	brlo	adc_res_num_low
00067d 2700                      	clr		templ
00067e 940e 0682                 	call	Calculate_average
                                 adc_res_num_low:
000680 930c                      	st		X,templ
                                 	
000681 9508                      ret
                                 
                                 
                                 Calculate_average:
000682 930f                      	push	templ
                                 
000683 2722                      	clr		temp_2
000684 2733                      	clr		temp_3
000685 2700                      	clr		templ
000686 2777                      	clr		count
000687 e0c6                      	ldi		YL,LOW(ADC_RES)
000688 e0d1                      	ldi		YH,HIGH(ADC_RES)
                                 
                                 aver_calc_next_byte:
000689 9119                      	ld		temph,Y+
00068a 0f21                      	add		temp_2,temph								; temp_3:temp_2      
00068b 1f30                      	adc		temp_3,templ
00068c 9573                      	inc		count
00068d 3270                      	cpi		count,32
00068e f3d0                      	brlo	aver_calc_next_byte
                                 
00068f 0f22                      	lsl		temp_2										;  8 (  3 )  
000690 1f33                      	rol		temp_3
000691 0f22                      	lsl		temp_2										
000692 1f33                      	rol		temp_3
000693 0f22                      	lsl		temp_2										
000694 1f33                      	rol		temp_3										;temp_3      
                                 
000695 2f13                      	mov		temph,temp_3
000696 bd13                      	out		OCR2,temph
                                 
                                 /*	mov		templ,temph
                                 	call	Send_UART*/
                                 
000697 910f                      	pop		templ
000698 9508                      ret	
                                 
                                 .dseg
                                 
000105                           ADC_NUM:		.byte	1
                                 
000106                           ADC_RES:		.byte	32
                                 
                                 .cseg
                                 .include	"TimeCorrect.asm"
                                 
                                      
                                 
                                 1.   .    ,         , -     
                                 ,      DS1307.   ,   ,   .  
                                                   -.
                                 
                                 2.       (     )      
                                 .         .
                                 
                                 3.       (     ).  -   temph.
                                 */
                                 
                                 //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////							1
                                 //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 Correct_time:
                                 
                                 	//   -  
000699 e7a0                      	ldi		XL,LOW(TWI_BUFFER_IN)
00069a e0b0                      	ldi		XH,HIGH(TWI_BUFFER_IN)
00069b 9612                      	adiw	XL,2
00069c 910c                      	ld		templ,X
                                 	//  ,    (    01:00:00)
00069d 3001                      	cpi		templ, 1
00069e f519                      	brne	exit_correct_time_proc
00069f 910e                      	ld		templ,-X													;
0006a0 3000                      	cpi		templ,0
0006a1 f501                      	brne	exit_correct_time_proc
0006a2 910e                      	ld		templ,-X													;
0006a3 3000                      	cpi		templ,0
0006a4 f469                      	brne	check_stop_correction_time	
0006a5 940e 06ca                 	call	Read_time_inaccuracy_from_RAM
                                 	//    -    (  = 1) - ,  - 
0006a7 ff17                      	sbrs	temph,7														
0006a8 c007                      	rjmp	clock_ahead
                                 	//  -       
0006a9 9511                      	neg		temph														;  
0006aa 940e 02a4                 	call	HEX_TO_BCD													;   bcd    
0006ac 24ff                      	clr		byte_address
0006ad 940e 0288                 	call	Write_byte_to_DS1307
0006af c012                      	rjmp	exit_correct_time_proc
                                 
                                 	//  
                                 clock_ahead:
0006b0 6042                      	sbr		state_flag,(1<<WWSM)										; ,  ,     
0006b1 c010                      	rjmp	exit_correct_time_proc
                                 
                                 // ,         1  00 ,    =   + 1
                                 //     = 1:00:01    WWSM
                                 check_stop_correction_time:
0006b2 ff41                      	sbrs	state_flag,WWSM
0006b3 c00e                      	rjmp	exit_correct_time_proc
0006b4 2f10                      	mov		temph,templ
0006b5 940e 0299                 	call	BCD_TO_HEX
0006b7 2f01                      	mov		templ,temph													;    BCD 
0006b8 940e 06ca                 	call	Read_time_inaccuracy_from_RAM								;  -  temph
0006ba 9513                      	inc		temph
0006bb 1710                      	cp		temph,templ													;         + 1
0006bc f429                      	brne	exit_correct_time_proc
0006bd 7f4d                      	cbr		state_flag,(1<<WWSM)										; 
0006be e011                      	ldi		temph,1
0006bf 24ff                      	clr		byte_address
0006c0 940e 0288                 	call	Write_byte_to_DS1307										;     = 1
                                 
                                 exit_correct_time_proc:
0006c2 9508                      ret
                                 
                                 //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////							2
                                 //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 Read_write_time_inaccuracy:	
0006c3 e9ec                      	ldi		ZL,LOW(2*TIME_INACCURACY_SEC_PER_DAY_CONST)					;      -
0006c4 e0fd                      	ldi		ZH,HIGH(2*TIME_INACCURACY_SEC_PER_DAY_CONST)
0006c5 9104                      	lpm		templ,Z
                                 	
0006c6 e2a6                      	ldi		XL,LOW(TIME_INACCURACY_SEC_PER_DAY_TEMP)					;       
0006c7 e0b1                      	ldi		XH,HIGH(TIME_INACCURACY_SEC_PER_DAY_TEMP)
0006c8 930c                      	st		X,templ
0006c9 9508                      ret
                                 
                                 //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////							3
                                 //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 Read_time_inaccuracy_from_RAM:
0006ca e2a6                      	ldi		XL,LOW(TIME_INACCURACY_SEC_PER_DAY_TEMP)					;       
0006cb e0b1                      	ldi		XH,HIGH(TIME_INACCURACY_SEC_PER_DAY_TEMP)
0006cc 911c                      	ld		temph,X
0006cd 9508                      ret
                                 
                                 .dseg 
                                 
000126                           TIME_INACCURACY_SEC_PER_DAY_TEMP:	.byte	1
                                 
                                 .cseg
                                 
                                 TIME_INACCURACY_SEC_PER_DAY_CONST:
0006ce 0006                      		.db		0x06,	0x00
                                 .include	"EEPROMFunctions.asm"
                                 
                                      eeprom
                                 1.     (5  -   (  ),   (  )
                                   )  eeprom      .   eeprom    .  
                                          .
                                  templ     (5 ).      eeprom 3 , ,    . 
                                  : 
                                 -   eeprom    ;
                                 -     ;
                                 -         TIMER_PARAMETERS_TEMP    ,
                                        (   > 59):
                                 -       .  ,     .
                                     :
                                 0 - min_work,
                                 1 - sec_work,
                                 2 - min_rest,
                                 3 - sec_rest,
                                 4 - round_work
                                 
                                 2.     eeprom.  XH:XL -   .  YL -  
                                 
                                 3.       TIMER_PARAMETERS_TEMP + templ.  templ -  ,  temph -   , temp_2 - .
                                 
                                 4.      TIMER_PARAMETERS_TEMP     .
                                 
                                 5.     eeprom   .
                                 
                                 6.    eeprom.  XH:XL -   .  YL -  .
                                 */
                                 
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////	1
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 Read_timer_parameters_from_eeprom:
0006cf e000                      	ldi		templ,0
                                 	
                                 next_param_from_eeprom:
0006d0 2fa0                      	mov		XL,templ										;  
0006d1 27bb                      	clr		XH
0006d2 940e 06f0                 	call	Read_byte_from_eeprom
0006d4 2f1c                      	mov		temph,YL
0006d5 5ca0                      	subi	XL,-EEPROM_PAGE_SIZE								;  
0006d6 940e 06f0                 	call	Read_byte_from_eeprom
0006d8 2f2c                      	mov		temp_2,YL
0006d9 5ca0                      	subi	XL,-EEPROM_PAGE_SIZE								;  
0006da 940e 06f0                 	call	Read_byte_from_eeprom
0006dc 2f3c                      	mov		temp_3,YL
                                 
                                 	//   -      
0006dd 1712                      	cp		temph,temp_2
0006de f481                      	brne	exit_read_timer_parameters_from_eeprom
0006df 1723                      	cp		temp_2,temp_3
0006e0 f471                      	brne	exit_read_timer_parameters_from_eeprom
0006e1 ff00                      	sbrs	templ,0											;  =1,     
0006e2 c003                      	rjmp	check_minutes_or_rounds							;  =1,      
0006e3 331c                      	cpi		temph,60										; ..  60
0006e4 f450                      	brsh	exit_read_timer_parameters_from_eeprom
0006e5 c002                      	rjmp	check_param_number
                                 check_minutes_or_rounds:
0006e6 3614                      	cpi		temph,100										;   ..  100
0006e7 f438                      	brsh	exit_read_timer_parameters_from_eeprom
                                 			
                                 check_param_number:
0006e8 940e 06f7                 	call	Write_timer_param_to_RAM						;     
0006ea 9503                      	inc		templ											; 
0006eb 3005                      	cpi		templ,5
0006ec f318                      	brlo	next_param_from_eeprom							;       
0006ed 940e 06fe                 	call	Write_timer_params_from_RAM_to_registers
                                 			
                                 exit_read_timer_parameters_from_eeprom:
0006ef 9508                      ret
                                 
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////	2
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 Read_byte_from_eeprom:
                                 
0006f0 99e1                      	sbic	EECR,EEWE
0006f1 cffe                      	rjmp	Read_byte_from_eeprom
0006f2 bbbf                      	out		EEARH,XH
0006f3 bbae                      	out		EEARL,XL
0006f4 9ae0                      	sbi		EECR,EERE
0006f5 b3cd                      	in		YL,EEDR
                                 
0006f6 9508                      ret
                                 
                                 //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////							3
                                 //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 Write_timer_param_to_RAM:
0006f7 2722                      	clr		temp_2
0006f8 e2e7                      	ldi		ZL,LOW(TIMER_PARAMETERS_TEMP)					;      
0006f9 e0f1                      	ldi		ZH,HIGH(TIMER_PARAMETERS_TEMP)
0006fa 0fe0                      	add		ZL,templ
0006fb 1ff2                      	adc		ZH,temp_2
0006fc 8310                      	st		Z,temph
0006fd 9508                      ret
                                 
                                 //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////							4
                                 //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 Write_timer_params_from_RAM_to_registers:
0006fe e2e7                      	ldi		ZL,LOW(TIMER_PARAMETERS_TEMP)					;      
0006ff e0f1                      	ldi		ZH,HIGH(TIMER_PARAMETERS_TEMP)
000700 9041                      	ld		min_work,Z+
000701 9031                      	ld		sec_work,Z+
000702 9071                      	ld		min_rest,Z+
000703 9061                      	ld		sec_rest,Z+
000704 8050                      	ld		round_work,Z
000705 9508                      ret
                                 
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////							5
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 Write_timer_parameters_to_eeprom:
                                 	
000706 27aa                      	clr		XL
000707 27bb                      	clr		XH
000708 2700                      	clr		templ
000709 2711                      	clr		temph
                                 
                                 write_timer_params_to_next_page:
                                 
00070a 3010                      	cpi		temph,0
00070b f031                      	breq	start_write_params_to_eeprom
00070c 951a                      	dec		temph
00070d e420                      	ldi		temp_2,EEPROM_PAGE_SIZE
00070e 2733                      	clr		temp_3
00070f 0fa2                      	add		XL,temp_2
000710 1fb3                      	adc		XH,temp_3
000711 cff8                      	rjmp	write_timer_params_to_next_page
                                 
                                 start_write_params_to_eeprom:
                                 
                                 	// 
000712 2dc4                      	mov		YL,min_work
000713 940e 072c                 	call	Write_byte_to_eeprom	
                                 	// 
000715 9611                      	adiw	XL,1
000716 2dc3                      	mov		YL,sec_work
000717 940e 072c                 	call	Write_byte_to_eeprom
                                 	// 
000719 9611                      	adiw	XL,1
00071a 2dc7                      	mov		YL,min_rest
00071b 940e 072c                 	call	Write_byte_to_eeprom
                                 	// 
00071d 9611                      	adiw	XL,1
00071e 2dc6                      	mov		YL,sec_rest
00071f 940e 072c                 	call	Write_byte_to_eeprom
                                 	// 
000721 9611                      	adiw	XL,1
000722 2dc5                      	mov		YL,round_work
000723 940e 072c                 	call	Write_byte_to_eeprom
                                 
000725 9503                      	inc		templ
000726 2f10                      	mov		temph,templ
000727 27aa                      	clr		XL
000728 27bb                      	clr		XH
000729 3003                      	cpi		templ,3
00072a f2f8                      	brlo	write_timer_params_to_next_page
00072b 9508                      ret
                                 
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 //////////							6
                                 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                 
                                 Write_byte_to_eeprom:
                                 	
00072c 99e1                      	sbic	EECR,EEWE
00072d cffe                      	rjmp	Write_byte_to_eeprom
                                 
00072e bbbf                      	out		EEARH, XH
00072f bbae                      	out		EEARL, XL
000730 bbcd                      	out		EEDR, YL
                                 
000731 9ae2                      	sbi		EECR,EEMWE
                                 
000732 9ae1                      	sbi		EECR,EEWE
                                 	
000733 9508                      ret
                                 
                                 .dseg 
                                 
000127                           TIMER_PARAMETERS_TEMP:	.byte	5
                                 
                                 
                                 program_begin:
                                 
000734 940e 02cb                 call	Start_time
000736 940e 06c3                 call	Read_write_time_inaccuracy						;         -   000738 940e 02e5                   
                                 call	Clear_timer_mode_counter						;    
                                 
                                 main:
00073a ff97                      //           00073b 940c 0741                 
00073d 940e 0584                 	sbrs	enc_state,T2IF
00073f 940e 0311                 	jmp		read_next_packet_main
                                 	call	Get_Next_Digit
000741 ff44                      	call	Encoder_proc
000742 940c 073a                 read_next_packet_main:
                                 	sbrs	state_flag,RPTF
000744 ff40                      	jmp		main
000745 940e 00da                 //    
000747 fd40                      	sbrs	state_flag,WWVM
000748 940e 0171                 	call	Clock_mode_proc							// 
00074a 940e 0619                 	sbrc	state_flag,WWVM
00074c 940e 0665                 	call	Timer_mode_proc							// 
                                 	call	UART_proc
00074e 940c 073a                 	call	Set_brightness
                                 
                                 jmp	main
                                 
                                 


RESOURCE USE INFORMATION
------------------------

Notice:
The register and instruction counts are symbol table hit counts,
and hence implicitly used resources are not counted, eg, the
'lpm' instruction without operands implicitly uses r0 and z,
none of which are counted.

x,y,z are separate entities in the symbol table and are
counted separately from r26..r31 here.

.dseg memory usage only counts static data declared with .byte

"ATmega16A" register use summary:
x  :  62 y  :  42 z  :  12 r0 :  21 r1 :  13 r2 :  13 r3 :  13 r4 :  13 
r5 :  15 r6 :  14 r7 :  13 r8 :   4 r9 :   2 r10:   4 r11:   2 r12:   8 
r13:   5 r14:  29 r15:  19 r16: 376 r17: 150 r18:  72 r19:  41 r20:  73 
r21:  10 r22:  10 r23:  33 r24:   6 r25:  27 r26:  61 r27:  52 r28:  46 
r29:  36 r30:  22 r31:  21 
Registers used: 35 out of 35 (100.0%)

"ATmega16A" instruction use summary:
.lds  :   0 .sts  :   0 adc   :  24 add   :  27 adiw  :   9 and   :   0 
andi  :  19 asr   :   0 bclr  :   0 bld   :   0 brbc  :   0 brbs  :   0 
brcc  :   0 brcs  :   0 break :   0 breq  :  31 brge  :   3 brhc  :   0 
brhs  :   0 brid  :   0 brie  :   0 brlo  :  25 brlt  :   0 brmi  :   0 
brne  :  66 brpl  :   0 brsh  :  16 brtc  :   0 brts  :   0 brvc  :   0 
brvs  :   0 bset  :   0 bst   :   0 call  :  86 cbi   :  11 cbr   :  21 
clc   :   0 clh   :   0 cli   :   1 cln   :   0 clr   : 100 cls   :   0 
clt   :   0 clv   :   0 clz   :   0 com   :   0 cp    :  47 cpc   :   0 
cpi   :  88 cpse  :   0 dec   :  16 eor   :   0 fmul  :   0 fmuls :   0 
fmulsu:   0 icall :   0 ijmp  :   0 in    :  16 inc   :  43 jmp   : 156 
ld    :  39 ldd   :   0 ldi   : 245 lds   :   0 lpm   :  11 lsl   :  14 
lsr   :   3 mov   :  55 movw  :   0 mul   :   0 muls  :   0 mulsu :   0 
neg   :   1 nop   :   0 or    :   3 ori   :   2 out   :  51 pop   :  25 
push  :  25 rcall :   0 ret   :  45 reti  :   5 rjmp  :  30 rol   :   7 
ror   :   0 sbc   :   1 sbci  :   0 sbi   :  20 sbic  :   3 sbis  :   1 
sbiw  :   0 sbr   :  16 sbrc  :  36 sbrs  :  30 sec   :   0 seh   :   0 
sei   :   2 sen   :   0 ser   :   0 ses   :   0 set   :   0 sev   :   0 
sez   :   0 sleep :   0 spm   :   0 st    :  71 std   :   0 sts   :   0 
sub   :   4 subi  :  10 swap  :   3 tst   :   6 wdr   :   0 
Instructions used: 49 out of 113 (43.4%)

"ATmega16A" memory use summary [bytes]:
Segment   Begin    End      Code   Data   Used    Size   Use%
---------------------------------------------------------------
[.cseg] 0x000000 0x000ea0   3612     84   3696   16384  22.6%
[.dseg] 0x000060 0x00012c      0    204    204    1024  19.9%
[.eseg] 0x000000 0x000000      0      0      0     512   0.0%

Assembly complete, 0 errors, 0 warnings
